{"version":3,"file":"plot-list.utils-B0O3ryPA.js","sources":["../../../bublik-ui/libs/bublik/features/history/src/lib/history-measurements/plot-list.hooks.ts","../../../bublik-ui/libs/bublik/features/history/src/lib/history-measurements/plot-list.utils.ts"],"sourcesContent":["/* SPDX-License-Identifier: Apache-2.0 */\n/* SPDX-FileCopyrightText: 2021-2023 OKTET Labs Ltd. */\n\nimport { skipToken } from '@reduxjs/toolkit/query';\n\nimport {\n\tbublikAPI,\n\tcreateBublikError,\n\tuseGetHistoryLinearQuery,\n\tuseGetMeasurementsQuery\n} from '@/services/bublik-api';\nimport { HISTORY_MAX_RESULTS_IDS } from '@/bublik/config';\nimport { useTabTitleWithPrefix } from '@/bublik/features/projects';\n\nimport { useHistoryQuery } from '../hooks';\nimport { useCombinedCharts } from './combined-charts.context';\n\nfunction useGetHistoryMeasurementsByResult() {\n\tconst { query } = useHistoryQuery();\n\n\tconst {\n\t\tdata: linearData,\n\t\tisLoading: isLinearLoading,\n\t\tisFetching: isLinearFetching,\n\t\tisError: isLinearError,\n\t\terror: linearError\n\t} = useGetHistoryLinearQuery(query.testName ? query : skipToken);\n\n\tconst {\n\t\tdata,\n\t\tisLoading: isChartsLoading,\n\t\tisFetching: isChartsFetching,\n\t\tisError: isChartsError,\n\t\terror: chartsError\n\t} = useGetMeasurementsQuery(linearData ? linearData.results_ids : skipToken);\n\n\tconst isLoading = isLinearLoading || isChartsLoading;\n\tconst isError = isChartsError || isLinearError;\n\tconst isFetching = isLinearFetching || isChartsFetching;\n\tconst resultIds = linearData?.results_ids;\n\tconst error =\n\t\tlinearData && linearData.results_ids.length > HISTORY_MAX_RESULTS_IDS\n\t\t\t? createBublikError({\n\t\t\t\t\tstatus: 400,\n\t\t\t\t\ttitle: 'Result ids limit',\n\t\t\t\t\tdescription:\n\t\t\t\t\t\t\"Number of result ID's is larger than limit. Please be more specific with your search query\"\n\t\t\t  })\n\t\t\t: chartsError || linearError;\n\n\treturn { data, isLoading, isError, resultIds, isFetching, error } as const;\n}\n\nfunction useGetHistoryMeasurements() {\n\tconst { query } = useHistoryQuery();\n\n\tconst {\n\t\tdata: linearData,\n\t\tisLoading: isLinearLoading,\n\t\tisFetching: isLinearFetching,\n\t\tisError: isLinearError,\n\t\terror: linearError\n\t} = useGetHistoryLinearQuery(query.testName ? query : skipToken);\n\n\tconst {\n\t\tdata,\n\t\tisLoading: isChartsLoading,\n\t\tisFetching: isChartsFetching,\n\t\tisError: isChartsError,\n\t\terror: chartsError\n\t} = bublikAPI.useGetTrendChartsQuery(\n\t\tlinearData ? linearData.results_ids : skipToken\n\t);\n\n\tconst isLoading = isLinearLoading || isChartsLoading;\n\tconst isError = isChartsError || isLinearError;\n\tconst isFetching = isLinearFetching || isChartsFetching;\n\tconst resultIds = linearData?.results_ids;\n\tconst error =\n\t\tlinearData && linearData.results_ids.length > HISTORY_MAX_RESULTS_IDS\n\t\t\t? createBublikError({\n\t\t\t\t\tstatus: 400,\n\t\t\t\t\ttitle: 'Result ids limit',\n\t\t\t\t\tdescription:\n\t\t\t\t\t\t\"Number of result ID's is larger than limit. Please be more specific with your search query\"\n\t\t\t  })\n\t\t\t: chartsError || linearError;\n\n\treturn { data, isLoading, isError, resultIds, isFetching, error } as const;\n}\n\nfunction useCombinedView() {\n\treturn useCombinedCharts();\n}\n\nfunction useHistoryMeasurementsTitle(testName?: string) {\n\tuseTabTitleWithPrefix([testName, 'Measurements - History - Bublik']);\n}\n\nexport {\n\tuseGetHistoryMeasurements,\n\tuseCombinedView,\n\tuseHistoryMeasurementsTitle,\n\tuseGetHistoryMeasurementsByResult\n};\n","/* SPDX-License-Identifier: Apache-2.0 */\n/* SPDX-FileCopyrightText: 2021-2023 OKTET Labs Ltd. */\nimport { SingleMeasurementChart } from '@/services/bublik-api';\nimport { PointSchema } from '@/shared/types';\nimport { Point } from '@/shared/types';\n\nfunction resolvePoint(\n\tplot: SingleMeasurementChart,\n\tdataIndex: number\n): Point | null {\n\tconst dimensions = plot.dataset?.[0];\n\tconst row = plot.dataset?.[dataIndex + 1];\n\n\tif (!dimensions || !row) return null;\n\n\tconst rawData = dimensions.reduce<Record<string, unknown>>(\n\t\t(acc, curr, idx) => {\n\t\t\tacc[curr] = row[idx];\n\t\t\treturn acc;\n\t\t},\n\t\t{}\n\t);\n\n\tconst result = PointSchema.safeParse(rawData);\n\n\tif (!result.success) return null;\n\n\treturn result.data;\n}\n\nexport { resolvePoint };\n"],"names":["useGetHistoryMeasurementsByResult","query","useHistoryQuery","linearData","isLinearLoading","isLinearFetching","isLinearError","linearError","useGetHistoryLinearQuery","skipToken","data","isChartsLoading","isChartsFetching","isChartsError","chartsError","useGetMeasurementsQuery","isLoading","isError","isFetching","resultIds","error","HISTORY_MAX_RESULTS_IDS","createBublikError","useGetHistoryMeasurements","bublikAPI","useCombinedView","useCombinedCharts","useHistoryMeasurementsTitle","testName","useTabTitleWithPrefix","resolvePoint","plot","dataIndex","dimensions","row","rawData","acc","curr","idx","result","PointSchema"],"mappings":"wKAiBA,SAASA,GAAoC,CAC5C,KAAM,CAAE,MAAAC,CAAA,EAAUC,EAAA,EAEZ,CACL,KAAMC,EACN,UAAWC,EACX,WAAYC,EACZ,QAASC,EACT,MAAOC,CAAA,EACJC,EAAyBP,EAAM,SAAWA,EAAQQ,CAAS,EAEzD,CACL,KAAAC,EACA,UAAWC,EACX,WAAYC,EACZ,QAASC,EACT,MAAOC,CAAA,EACJC,EAAwBZ,EAAaA,EAAW,YAAcM,CAAS,EAErEO,EAAYZ,GAAmBO,EAC/BM,EAAUJ,GAAiBP,EAC3BY,EAAab,GAAoBO,EACjCO,EAAYhB,GAAY,YACxBiB,EACLjB,GAAcA,EAAW,YAAY,OAASkB,EAC3CC,EAAkB,CAClB,OAAQ,IACR,MAAO,mBACP,YACC,4FAAA,CACA,EACDR,GAAeP,EAEnB,MAAO,CAAE,KAAAG,EAAM,UAAAM,EAAW,QAAAC,EAAS,UAAAE,EAAW,WAAAD,EAAY,MAAAE,CAAA,CAC3D,CAEA,SAASG,GAA4B,CACpC,KAAM,CAAE,MAAAtB,CAAA,EAAUC,EAAA,EAEZ,CACL,KAAMC,EACN,UAAWC,EACX,WAAYC,EACZ,QAASC,EACT,MAAOC,CAAA,EACJC,EAAyBP,EAAM,SAAWA,EAAQQ,CAAS,EAEzD,CACL,KAAAC,EACA,UAAWC,EACX,WAAYC,EACZ,QAASC,EACT,MAAOC,CAAA,EACJU,EAAU,uBACbrB,EAAaA,EAAW,YAAcM,CAAA,EAGjCO,EAAYZ,GAAmBO,EAC/BM,EAAUJ,GAAiBP,EAC3BY,EAAab,GAAoBO,EACjCO,EAAYhB,GAAY,YACxBiB,EACLjB,GAAcA,EAAW,YAAY,OAASkB,EAC3CC,EAAkB,CAClB,OAAQ,IACR,MAAO,mBACP,YACC,4FAAA,CACA,EACDR,GAAeP,EAEnB,MAAO,CAAE,KAAAG,EAAM,UAAAM,EAAW,QAAAC,EAAS,UAAAE,EAAW,WAAAD,EAAY,MAAAE,CAAA,CAC3D,CAEA,SAASK,GAAkB,CAC1B,OAAOC,EAAA,CACR,CAEA,SAASC,EAA4BC,EAAmB,CACvDC,EAAsB,CAACD,EAAU,iCAAiC,CAAC,CACpE,CC3FA,SAASE,EACRC,EACAC,EACe,CACf,MAAMC,EAAaF,EAAK,UAAU,CAAC,EAC7BG,EAAMH,EAAK,UAAUC,EAAY,CAAC,EAExC,GAAI,CAACC,GAAc,CAACC,EAAK,OAAO,KAEhC,MAAMC,EAAUF,EAAW,OAC1B,CAACG,EAAKC,EAAMC,KACXF,EAAIC,CAAI,EAAIH,EAAII,CAAG,EACZF,GAER,CAAA,CAAC,EAGIG,EAASC,EAAY,UAAUL,CAAO,EAE5C,OAAKI,EAAO,QAELA,EAAO,KAFc,IAG7B"}