{"version":3,"file":"import-page-C1whKHHJ.js","sources":["../../../bublik-ui/libs/shared/tailwind-ui/src/lib/combo-select/select-field/select-field.tsx","../../../bublik-ui/libs/bublik/features/run-import/src/lib/utils.ts","../../../bublik-ui/libs/bublik/features/run-import/src/lib/import-events-table/import-event-table-utils.ts","../../../bublik-ui/libs/bublik/features/run-import/src/lib/import-events-table/import-log.component.tsx","../../../bublik-ui/libs/bublik/features/run-import/src/lib/import-events-table/import-event-table.columns.tsx","../../../bublik-ui/libs/bublik/features/run-import/src/lib/import-events-table/import-event-table.component.tsx","../../../bublik-ui/libs/bublik/features/run-import/src/lib/import-run-filter-form/import-run-filter-form.component.tsx","../../../bublik-ui/libs/bublik/features/run-import/src/lib/import-events-table/import-event-table.container.tsx","../../../bublik-ui/libs/bublik/features/run-import/src/lib/import-run-form/import-run-form.utils.ts","../../../bublik-ui/libs/bublik/features/run-import/src/lib/import-run-form/import-run-form.component.tsx","../../../bublik-ui/libs/bublik/features/run-import/src/lib/import-run-form/import-run-form-modal.component.tsx","../../../bublik-ui/libs/bublik/features/run-import/src/lib/import-run-form/import-run-form-result-list.component.tsx","../../../bublik-ui/libs/bublik/features/run-import/src/lib/import-run-form/import-run-form.container.tsx","../../../bublik-ui/apps/bublik/src/pages/import-page/import-page.tsx"],"sourcesContent":["/* SPDX-License-Identifier: Apache-2.0 */\n/* SPDX-FileCopyrightText: 2021-2023 OKTET Labs Ltd. */\nimport { Control, FieldValues, Path, useController } from 'react-hook-form';\n\nimport { SelectInput, SelectProps } from '../select';\n\nexport type SelectFieldProps<T extends FieldValues> = SelectProps & {\n\tname: Path<T>;\n\tcontrol: Control<T>;\n};\n\nexport const SelectField = <T extends FieldValues>(\n\tprops: SelectFieldProps<T>\n) => {\n\tconst { field } = useController({\n\t\tname: props.name,\n\t\tcontrol: props.control\n\t});\n\n\treturn (\n\t\t<SelectInput\n\t\t\t{...props}\n\t\t\t{...field}\n\t\t\tonValueChange={field.onChange}\n\t\t\tref={field.ref}\n\t\t/>\n\t);\n};\n","/* SPDX-License-Identifier: Apache-2.0 */\n/* SPDX-FileCopyrightText: 2021-2023 OKTET Labs Ltd. */\nimport { Facility, Severity } from '@/shared/types';\n\nimport { SelectValue } from '@/shared/tailwind-ui';\n\nexport const SEVERITY_MAP = new Map<Severity, string>([\n\t[Severity.INFO, 'Info'],\n\t[Severity.ERROR, 'Error'],\n\t[Severity.WARNING, 'Warning'],\n\t[Severity.DEBUG, 'Debug']\n]);\n\nexport const FACILITY_MAP = new Map<Facility, string>([\n\t[Facility.AddTags, 'Add Tags'],\n\t[Facility.Celery, 'Celery'],\n\t[Facility.ImportRuns, 'Import'],\n\t[Facility.MetaCaterigozation, 'Meta Categorization']\n]);\n\nexport const severityOptions: SelectValue[] = [\n\t{ value: 'all', displayValue: 'All' },\n\t...Array.from(SEVERITY_MAP.entries()).map(([value, displayValue]) => ({\n\t\tvalue,\n\t\tdisplayValue\n\t}))\n];\n\nexport const facilityOptions: SelectValue[] = [\n\t{ value: 'all', displayValue: 'All' },\n\t...Array.from(FACILITY_MAP.entries()).map(([value, displayValue]) => ({\n\t\tvalue,\n\t\tdisplayValue\n\t}))\n];\n","/* SPDX-License-Identifier: Apache-2.0 */\n/* SPDX-FileCopyrightText: 2021-2023 OKTET Labs Ltd. */\nimport { Severity } from '@/shared/types';\n\nexport const getSeverityBgColor = (severity: Severity) => {\n\tconst colorMap = new Map<Severity, string>([\n\t\t[Severity.DEBUG, 'bg-badge-6'],\n\t\t[Severity.ERROR, 'bg-badge-5 text-text-unexpected'],\n\t\t[Severity.WARNING, 'bg-bg-warning text-white']\n\t]);\n\n\treturn colorMap.get(severity) ?? 'bg-badge-0';\n};\n","/* SPDX-License-Identifier: Apache-2.0 */\n/* SPDX-FileCopyrightText: 2021-2023 OKTET Labs Ltd. */\nimport {\n\tComponentProps,\n\tcreateContext,\n\tElementRef,\n\tPropsWithChildren,\n\tuseCallback,\n\tuseContext,\n\tuseEffect,\n\tuseRef,\n\tuseState\n} from 'react';\nimport {\n\tBooleanParam,\n\tStringParam,\n\tuseQueryParam,\n\twithDefault\n} from 'use-query-params';\nimport { PauseIcon, RocketIcon } from '@radix-ui/react-icons';\nimport { skipToken } from '@reduxjs/toolkit/query';\nimport { AnimatePresence, motion } from 'framer-motion';\n\nimport { getErrorMessage, useGetImportLogQuery } from '@/services/bublik-api';\nimport {\n\tButtonTw,\n\tCardHeader,\n\tcn,\n\tDialogClose,\n\tDialogPortal,\n\tDrawerContent,\n\tDrawerRoot,\n\tIcon,\n\tSkeleton,\n\ttoast,\n\tTooltip\n} from '@/shared/tailwind-ui';\nimport { ImportJsonLog } from '@/shared/types';\nimport { useCopyToClipboard, useLocalStorage } from '@/shared/hooks';\nimport { routes } from '@/router';\nimport { config } from '@/bublik/config';\nimport { LinkWithProject } from '@/bublik/features/projects';\nimport {\n\tcreateColumnHelper,\n\tflexRender,\n\tgetCoreRowModel,\n\tuseReactTable\n} from '@tanstack/react-table';\n\ninterface ImportLogContext {\n\ttoggle: (taskId: string, enablePolling?: boolean) => () => void;\n}\n\nconst ImportLogContext = createContext<ImportLogContext | null>(null);\n\nfunction useImportLog() {\n\tconst context = useContext(ImportLogContext);\n\n\tif (!context) {\n\t\tthrow new Error(\n\t\t\t'useImportLog must be used within <ImportLogContextProvider />'\n\t\t);\n\t}\n\n\treturn context;\n}\n\nfunction ImportLogProvider({ children }: PropsWithChildren) {\n\tconst [taskId, setTaskId] = useQueryParam('taskId', StringParam);\n\tconst [enablePolling = false, setEnablePolling] = useQueryParam(\n\t\t'poll',\n\t\twithDefault(BooleanParam, false)\n\t);\n\n\tfunction toggle(task: string, enablePolling?: boolean) {\n\t\treturn () => {\n\t\t\tsetTaskId((t) => (t ? null : task));\n\n\t\t\tif (typeof enablePolling !== 'undefined') {\n\t\t\t\tsetEnablePolling(enablePolling);\n\t\t\t}\n\t\t};\n\t}\n\n\tfunction close() {\n\t\tsetTaskId(null);\n\t\tsetEnablePolling(null);\n\t}\n\n\treturn (\n\t\t<ImportLogContext.Provider value={{ toggle }}>\n\t\t\t<JsonLogContainer\n\t\t\t\ttaskId={taskId}\n\t\t\t\tenablePolling={enablePolling}\n\t\t\t\tclose={close}\n\t\t\t/>\n\t\t\t{children}\n\t\t</ImportLogContext.Provider>\n\t);\n}\n\ninterface JsonLogContainerProps {\n\ttaskId?: string | null;\n\tenablePolling?: boolean;\n\tclose: () => void;\n}\n\nfunction JsonLogContainer(props: JsonLogContainerProps) {\n\tconst { taskId, enablePolling, close } = props;\n\n\treturn (\n\t\t<DrawerRoot\n\t\t\topen={!!taskId}\n\t\t\tonOpenChange={(open) => {\n\t\t\t\tif (!open) close();\n\t\t\t}}\n\t\t>\n\t\t\t<DialogPortal>\n\t\t\t\t<DrawerContent\n\t\t\t\t\tclassName=\"w-[80vw] flex flex-col\"\n\t\t\t\t\tonInteractOutside={close}\n\t\t\t\t\tonEscapeKeyDown={close}\n\t\t\t\t>\n\t\t\t\t\t<ImportLogTableContainer\n\t\t\t\t\t\ttaskId={taskId}\n\t\t\t\t\t\tenablePolling={enablePolling}\n\t\t\t\t\t/>\n\t\t\t\t</DrawerContent>\n\t\t\t</DialogPortal>\n\t\t</DrawerRoot>\n\t);\n}\n\nfunction getRunIdFromLogs(data: { message: string }[]): number | null {\n\tconst patterns = [\n\t\t/run id is (\\d+)/i, // Matches \"run id is 12345\"\n\t\t/mi run id:\\s*(\\d+)/i // Matches \"MI RUN ID: 12345\"\n\t];\n\n\tfor (const entry of data) {\n\t\tfor (const pattern of patterns) {\n\t\t\tconst match = entry.message.match(pattern);\n\t\t\tif (match) {\n\t\t\t\treturn parseInt(match[1], 10);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn null; // Return null if no patterns match\n}\n\nconst BG_CLASS = 'bg-[#24292f]';\n\nexport interface ImportLogTableContainerProps {\n\ttaskId: ComponentProps<typeof JsonLogContainer>['taskId'];\n\tenablePolling: ComponentProps<typeof JsonLogContainer>['enablePolling'];\n}\n\nexport const ImportLogTableContainer = (\n\tprops: ImportLogTableContainerProps\n) => {\n\tconst { taskId } = props;\n\tconst [isAtBottom, setIsAtBottom] = useState(true);\n\tconst [shouldPoll, setShouldPoll] = useState(props.enablePolling);\n\tconst [textWrap, setTextWrap] = useLocalStorage('import-log-text-wrap', true);\n\n\tconst { data, isLoading, isFetching, error } = useGetImportLogQuery(\n\t\ttaskId ? taskId : skipToken,\n\t\t{\n\t\t\tpollingInterval: shouldPoll ? 5000 : 0\n\t\t}\n\t);\n\n\tconst scrollRef = useRef<ElementRef<'div'>>(null);\n\n\tconst [, copy] = useCopyToClipboard({\n\t\tonSuccess: () => toast.success('Copied to clipboard')\n\t});\n\n\tconst handleScroll = useCallback(() => {\n\t\tconst el = scrollRef.current;\n\t\tif (!el) return;\n\t\tconst isBottom =\n\t\t\tMath.abs(el.scrollHeight - el.scrollTop - el.clientHeight) < 10;\n\t\tsetIsAtBottom(isBottom);\n\t}, []);\n\n\tuseEffect(() => {\n\t\tconst el = scrollRef.current;\n\t\tif (!el) return;\n\n\t\tel.addEventListener('scroll', handleScroll);\n\t\treturn () => el.removeEventListener('scroll', handleScroll);\n\t}, [handleScroll]);\n\n\tuseEffect(() => {\n\t\tconst el = scrollRef.current;\n\t\tif (!el || !data) return;\n\n\t\tconst maybeRunId = getRunIdFromLogs(data);\n\t\tif (maybeRunId) {\n\t\t\tsetShouldPoll(false);\n\t\t\treturn;\n\t\t}\n\n\t\tif (!shouldPoll || !isAtBottom) return;\n\n\t\tsetTimeout(\n\t\t\t() => el.scrollTo({ top: el.scrollHeight, behavior: 'smooth' }),\n\t\t\t0\n\t\t);\n\t}, [data, shouldPoll, isAtBottom, isFetching]);\n\n\tif (error) {\n\t\treturn <ImportLogError error={error} />;\n\t}\n\n\tif (isLoading) {\n\t\treturn <Skeleton className=\"w-full h-full\" />;\n\t}\n\n\tif (!data) {\n\t\treturn <div className=\"grid place-items-center h-full\">Not Log Found</div>;\n\t}\n\n\tconst maybeRunId = getRunIdFromLogs(data);\n\tconst showPausedChip = shouldPoll && !isAtBottom;\n\n\treturn (\n\t\t<>\n\t\t\t<CardHeader\n\t\t\t\tlabel={\n\t\t\t\t\t<div className=\"flex items-center gap-2\">\n\t\t\t\t\t\t<span className=\"text-text-primary text-[0.75rem] font-semibold leading-[0.875rem]\">\n\t\t\t\t\t\t\tImport: {taskId}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<Spinner show={Boolean(shouldPoll)} />\n\t\t\t\t\t</div>\n\t\t\t\t}\n\t\t\t\tclassName=\"px-4 py-2 flex gap-4 items-center justify-between\"\n\t\t\t>\n\t\t\t\t<div className=\"flex gap-2 items-center\">\n\t\t\t\t\t<HeaderLinks runId={maybeRunId} />\n\t\t\t\t\t<ButtonTw asChild variant=\"secondary\" size=\"xss\">\n\t\t\t\t\t\t<a\n\t\t\t\t\t\t\thref={`${config.oldBaseUrl}/flower/task/${taskId}`}\n\t\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\t\trel=\"noreferrer\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<RocketIcon className=\"mr-1.5\" />\n\t\t\t\t\t\t\t<span>Task</span>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</ButtonTw>\n\t\t\t\t\t<ButtonTw\n\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\tsize=\"xss\"\n\t\t\t\t\t\tonClick={async () => {\n\t\t\t\t\t\t\tif (!data) return;\n\t\t\t\t\t\t\tawait copy(data.map((d) => d.message.trim()).join('\\n'));\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Icon name=\"PaperStack\" size={20} className=\"mr-1.5\" />\n\t\t\t\t\t\t<span>Copy Log</span>\n\t\t\t\t\t</ButtonTw>\n\t\t\t\t\t<ButtonTw\n\t\t\t\t\t\tvariant={textWrap ? 'primary' : 'secondary'}\n\t\t\t\t\t\tonClick={() => setTextWrap((v) => !v)}\n\t\t\t\t\t\tsize=\"xss\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Icon name=\"TextWrap\" size={18} className=\"mr-1.5\" />\n\t\t\t\t\t\t<span>Line Wrap</span>\n\t\t\t\t\t</ButtonTw>\n\t\t\t\t\t<DialogClose className=\"p-0.5 rounded-md hover:bg-primary-wash hover:text-primary text-text-menu\">\n\t\t\t\t\t\t<Icon name=\"CrossSimple\" size={20} />\n\t\t\t\t\t</DialogClose>\n\t\t\t\t</div>\n\t\t\t</CardHeader>\n\t\t\t<div className=\"relative flex-grow overflow-hidden\">\n\t\t\t\t<AnimatePresence>\n\t\t\t\t\t{showPausedChip ? (\n\t\t\t\t\t\t<motion.div\n\t\t\t\t\t\t\tclassName=\"flex items-center gap-1 px-2 py-0.5 text-xs text-white rounded-full bg-primary absolute bottom-12 left-1/2 -translate-x-1/2\"\n\t\t\t\t\t\t\tinitial={{ opacity: 0, y: 10 }}\n\t\t\t\t\t\t\tanimate={{ opacity: 1, y: 0 }}\n\t\t\t\t\t\t\texit={{ opacity: 0, y: 10 }}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<PauseIcon className=\"size-4\" />\n\t\t\t\t\t\t\t<span>Scrolling Paused</span>\n\t\t\t\t\t\t</motion.div>\n\t\t\t\t\t) : null}\n\t\t\t\t</AnimatePresence>\n\t\t\t\t<div\n\t\t\t\t\tclassName={cn('flex-grow overflow-hidden h-full', BG_CLASS)}\n\t\t\t\t\tref={scrollRef}\n\t\t\t\t>\n\t\t\t\t\t<ImportLogTable logs={data} textWrap={textWrap} />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</>\n\t);\n};\n\ninterface ImportLogErrorProps {\n\terror: unknown;\n}\n\nfunction ImportLogError({ error }: ImportLogErrorProps) {\n\tconst { status, title, description } = getErrorMessage(error);\n\n\treturn (\n\t\t<div className=\"grid place-items-center h-full\">\n\t\t\t<div className=\"flex flex-col items-center text-center\">\n\t\t\t\t<Icon\n\t\t\t\t\tname=\"TriangleExclamationMark\"\n\t\t\t\t\tsize={24}\n\t\t\t\t\tclassName=\"text-text-unexpected\"\n\t\t\t\t/>\n\t\t\t\t<h3 className=\"mt-2 text-sm font-medium text-gray-900\">\n\t\t\t\t\t{status} {title}\n\t\t\t\t</h3>\n\t\t\t\t<p className=\"mt-1 text-sm text-gray-500\">{description}</p>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\ninterface SpinnerProps {\n\tshow: boolean;\n}\n\nfunction Spinner(props: SpinnerProps) {\n\treturn (\n\t\t<AnimatePresence>\n\t\t\t{props.show ? (\n\t\t\t\t<motion.div\n\t\t\t\t\tinitial={{ opacity: 0 }}\n\t\t\t\t\tanimate={{ opacity: 1 }}\n\t\t\t\t\texit={{ opacity: 0 }}\n\t\t\t\t>\n\t\t\t\t\t<Tooltip content=\"Run import is in progress\">\n\t\t\t\t\t\t<Icon\n\t\t\t\t\t\t\tname=\"InformationCircleProgress\"\n\t\t\t\t\t\t\tsize={24}\n\t\t\t\t\t\t\tclassName=\"text-primary p-0.5 animate-spin\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Tooltip>\n\t\t\t\t</motion.div>\n\t\t\t) : null}\n\t\t</AnimatePresence>\n\t);\n}\n\ninterface HeaderLinksProps {\n\trunId?: number | null;\n}\n\nfunction HeaderLinks({ runId }: HeaderLinksProps) {\n\tif (!runId) return;\n\n\treturn (\n\t\t<>\n\t\t\t<ButtonTw asChild variant=\"secondary\" size=\"xss\">\n\t\t\t\t<LinkWithProject to={routes.log({ runId })} target=\"_blank\">\n\t\t\t\t\t<Icon name=\"BoxArrowRight\" className=\"mr-1.5\" />\n\t\t\t\t\tLog\n\t\t\t\t</LinkWithProject>\n\t\t\t</ButtonTw>\n\t\t\t<ButtonTw asChild variant=\"secondary\" size=\"xss\">\n\t\t\t\t<LinkWithProject to={routes.run({ runId })} target=\"_blank\">\n\t\t\t\t\t<Icon name=\"BoxArrowRight\" className=\"mr-1.5\" />\n\t\t\t\t\tRun\n\t\t\t\t</LinkWithProject>\n\t\t\t</ButtonTw>\n\t\t</>\n\t);\n}\n\nconst helper = createColumnHelper<ImportJsonLog>();\n\ninterface GetColumnsConfig {\n\ttextWrap: boolean;\n}\n\nfunction getColumns({ textWrap }: GetColumnsConfig) {\n\treturn [\n\t\thelper.display({\n\t\t\tid: 'line-number',\n\t\t\theader: '#',\n\t\t\tcell: ({ row }) => row.index + 1,\n\t\t\tmeta: { className: 'text-[#8c959f] hover:text-primary hover:underline' }\n\t\t}),\n\t\thelper.accessor('asctime', {\n\t\t\theader: 'Time',\n\t\t\tcell: (info) => info.getValue()\n\t\t}),\n\t\thelper.accessor('levelname', {\n\t\t\theader: 'Level',\n\t\t\tcell: (info) => info.getValue()\n\t\t}),\n\t\thelper.accessor('module', {\n\t\t\theader: 'Module',\n\t\t\tcell: (info) => info.getValue()\n\t\t}),\n\t\thelper.accessor('message', {\n\t\t\theader: 'Message',\n\t\t\tcell: (info) => info.getValue(),\n\t\t\tmeta: {\n\t\t\t\tclassName: textWrap\n\t\t\t\t\t? 'whitespace-pre-wrap break-words'\n\t\t\t\t\t: 'whitespace-nowrap'\n\t\t\t}\n\t\t})\n\t];\n}\n\nconst getRowClassName = (level: string) => {\n\tconst baseClasses = 'hover:bg-gray-600/20';\n\n\tif (level === 'CRITICAL') {\n\t\treturn `${baseClasses} bg-red-950/30 text-red-100 hover:text-red-50 font-semibold`;\n\t}\n\tif (level === 'ERROR') {\n\t\treturn `${baseClasses} bg-red-900/20 text-red-200 hover:text-red-100`;\n\t}\n\tif (level === 'WARN' || level === 'WARNING') {\n\t\treturn `${baseClasses} bg-yellow-900/20 text-yellow-200 hover:text-yellow-100`;\n\t}\n\tif (level === 'DEBUG') {\n\t\treturn `${baseClasses} text-gray-400 hover:text-gray-300`;\n\t}\n\n\treturn `${baseClasses} text-gray-200 hover:text-gray-50`;\n};\n\nexport interface ImportLogTableProps {\n\tlogs: ImportJsonLog[];\n\ttextWrap?: boolean;\n}\n\nexport const ImportLogTable = (props: ImportLogTableProps) => {\n\tconst { textWrap = true, logs } = props;\n\n\tconst table = useReactTable<ImportJsonLog>({\n\t\tdata: logs,\n\t\tcolumns: getColumns({ textWrap }),\n\t\tgetCoreRowModel: getCoreRowModel()\n\t});\n\n\treturn (\n\t\t<div className=\"font-mono text-xs leading-5 pb-12 px-2 flex-1 h-full overflow-auto\">\n\t\t\t<table className=\"w-full border-collapse\">\n\t\t\t\t{table.getHeaderGroups().map((group) => (\n\t\t\t\t\t<thead key={group.id}>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t{group.headers.map((header) => (\n\t\t\t\t\t\t\t\t<th\n\t\t\t\t\t\t\t\t\tkey={header.id}\n\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t'px-1 py-2 text-left text-gray-400 font-semibold sticky top-0',\n\t\t\t\t\t\t\t\t\t\tBG_CLASS\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{flexRender(\n\t\t\t\t\t\t\t\t\t\theader.column.columnDef.header,\n\t\t\t\t\t\t\t\t\t\theader.getContext()\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</thead>\n\t\t\t\t))}\n\t\t\t\t<tbody>\n\t\t\t\t\t{table.getRowModel().rows.map((row) => {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<tr\n\t\t\t\t\t\t\t\tkey={row.id}\n\t\t\t\t\t\t\t\tclassName={getRowClassName(row.original.levelname)}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{row.getVisibleCells().map((cell) => {\n\t\t\t\t\t\t\t\t\tconst className = cell.column.columnDef.meta?.className ?? '';\n\n\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t<td\n\t\t\t\t\t\t\t\t\t\t\tkey={cell.id}\n\t\t\t\t\t\t\t\t\t\t\tclassName={cn(`px-1 whitespace-nowrap`, className)}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t{flexRender(\n\t\t\t\t\t\t\t\t\t\t\t\tcell.column.columnDef.cell,\n\t\t\t\t\t\t\t\t\t\t\t\tcell.getContext()\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t\t</tbody>\n\t\t\t</table>\n\t\t</div>\n\t);\n};\n\nexport {\n\tJsonLogContainer,\n\tImportLogProvider,\n\tuseImportLog,\n\ttype JsonLogContainerProps\n};\n","/* SPDX-License-Identifier: Apache-2.0 */\n/* SPDX-FileCopyrightText: 2021-2023 OKTET Labs Ltd. */\nimport { ComponentProps, ComponentType } from 'react';\nimport { createColumnHelper } from '@tanstack/react-table';\nimport { z } from 'zod';\nimport { RocketIcon } from '@radix-ui/react-icons';\n\nimport { Facility, LogEventWithChildren, Severity } from '@/shared/types';\nimport { config } from '@/bublik/config';\nimport { LinkWithProject } from '@/bublik/features/projects';\nimport { useImportRunsMutation } from '@/services/bublik-api';\nimport {\n\tBadge,\n\tButtonTw,\n\tcn,\n\tIcon,\n\ttoast,\n\tTooltip\n} from '@/shared/tailwind-ui';\nimport { formatTimeToDot } from '@/shared/utils';\nimport { routes } from '@/router';\n\nimport { SEVERITY_MAP } from '../utils';\nimport { getSeverityBgColor } from './import-event-table-utils';\nimport { useImportLog } from './import-log.component';\nimport { FacilityBadge } from './import-event-table.component';\n\nexport function getBgByStatus(status: string): string {\n\tconst statusMap: Record<string, string> = {\n\t\tSUCCESS: 'bg-bg-ok',\n\t\tFAILURE: 'bg-bg-error',\n\t\tSTARTED: 'bg-bg-running',\n\t\tRECEIVED: 'bg-gray-400'\n\t};\n\n\treturn statusMap[status] ?? '';\n}\n\nexport function getIconByStatus(status: string) {\n\tconst statusMap: Record<\n\t\tstring,\n\t\tComponentType<Omit<ComponentProps<typeof Icon>, 'name'>>\n\t> = {\n\t\tSUCCESS: (props) => <Icon name=\"InformationCircleCheckmark\" {...props} />,\n\t\tFAILURE: (props) => <Icon name=\"InformationCircleCrossMark\" {...props} />,\n\t\tSTARTED: (props) => <Icon name=\"Play\" {...props} />,\n\t\tRECEIVED: (props) => <Icon name=\"Download\" {...props} />\n\t};\n\n\treturn statusMap[status];\n}\n\nconst columnHelper = createColumnHelper<LogEventWithChildren>();\n\ninterface ActionCellProps {\n\ttaskId?: string | null;\n\trunId?: number | null;\n\tstatus?: string;\n}\n\nfunction ActionsCell(props: ActionCellProps) {\n\tconst { runId, taskId, status } = props;\n\tconst { toggle } = useImportLog();\n\n\tif (!taskId) {\n\t\treturn (\n\t\t\t<div className=\"flex items-center gap-2 px-2\">\n\t\t\t\t<Tooltip content=\"No celery task available\">\n\t\t\t\t\t<Icon\n\t\t\t\t\t\tname=\"TriangleExclamationMark\"\n\t\t\t\t\t\tsize={20}\n\t\t\t\t\t\tclassName=\"text-text-unexpected\"\n\t\t\t\t\t/>\n\t\t\t\t</Tooltip>\n\t\t\t</div>\n\t\t);\n\t}\n\n\treturn (\n\t\t<div className=\"flex flex-col justify-center gap-1 w-fit\">\n\t\t\t{runId && (\n\t\t\t\t<LinkWithProject to={routes.run({ runId })}>\n\t\t\t\t\t<ButtonTw variant=\"secondary\" size=\"xss\" className=\"justify-start\">\n\t\t\t\t\t\t<Icon name=\"BoxArrowRight\" size={20} className=\"mr-1.5\" />\n\t\t\t\t\t\t<span>Run</span>\n\t\t\t\t\t</ButtonTw>\n\t\t\t\t</LinkWithProject>\n\t\t\t)}\n\t\t\t<ButtonTw\n\t\t\t\tvariant=\"secondary\"\n\t\t\t\tsize=\"xss\"\n\t\t\t\tclassName=\"justify-start\"\n\t\t\t\tonClick={toggle(taskId, status === 'STARTED')}\n\t\t\t>\n\t\t\t\t<Icon name=\"Paper\" size={20} className=\"mr-1.5\" />\n\t\t\t\t<span>Log</span>\n\t\t\t</ButtonTw>\n\t\t\t<ButtonTw\n\t\t\t\tvariant=\"secondary\"\n\t\t\t\tsize=\"xss\"\n\t\t\t\tclassName=\"justify-start\"\n\t\t\t\tasChild\n\t\t\t>\n\t\t\t\t<a\n\t\t\t\t\thref={`${config.oldBaseUrl}/flower/task/${taskId}`}\n\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\trel=\"noreferrer\"\n\t\t\t\t>\n\t\t\t\t\t<RocketIcon className=\"mr-1.5 size-4\" />\n\t\t\t\t\t<span>Task</span>\n\t\t\t\t</a>\n\t\t\t</ButtonTw>\n\t\t</div>\n\t);\n}\n\nexport const columns = [\n\tcolumnHelper.accessor('status', {\n\t\tid: 'EVENT_TYPE',\n\t\theader: '',\n\t\tcell: (cell) => {\n\t\t\tconst status = cell.getValue();\n\t\t\tconst Icon = getIconByStatus(status);\n\n\t\t\treturn (\n\t\t\t\t<Tooltip content={status} side=\"right\" align=\"start\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t'h-[calc(100%+2px)] w-[24px] flex flex-col items-center',\n\t\t\t\t\t\t\tcell.row.getIsExpanded() ? 'rounded-tl' : 'rounded-l',\n\t\t\t\t\t\t\tgetBgByStatus(status)\n\t\t\t\t\t\t)}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Icon className=\"mt-3.5 text-white\" size={18} />\n\t\t\t\t\t</div>\n\t\t\t\t</Tooltip>\n\t\t\t);\n\t\t},\n\t\tmeta: { className: 'p-0', width: '24px' }\n\t}),\n\tcolumnHelper.accessor('celery_task', {\n\t\tid: 'ACTIONS',\n\t\theader: () => <span className=\"pl-2\">Actions</span>,\n\t\tcell: (cell) => (\n\t\t\t<ActionsCell\n\t\t\t\ttaskId={cell.getValue()}\n\t\t\t\trunId={cell.row.original.run_id}\n\t\t\t\tstatus={cell.row.original.status}\n\t\t\t/>\n\t\t),\n\t\tmeta: { width: 'min-content' }\n\t}),\n\tcolumnHelper.accessor('timestamp', {\n\t\theader: 'Date',\n\t\tcell: (cell) => {\n\t\t\tconst date = cell.getValue();\n\n\t\t\tif (!date) return null;\n\n\t\t\treturn formatTimeToDot(date);\n\t\t},\n\t\tmeta: { width: '0.1fr' }\n\t}),\n\tcolumnHelper.accessor('facility', {\n\t\theader: () => <span className=\"pl-2\">Facility</span>,\n\t\tcell: (cell) => {\n\t\t\tconst facility = cell.getValue();\n\n\t\t\treturn <FacilityBadge facility={facility} />;\n\t\t},\n\t\tmeta: { width: '0.1fr' }\n\t}),\n\tcolumnHelper.accessor('severity', {\n\t\theader: () => <span className=\"pl-2\">Severity</span>,\n\t\tcell: (cell) => {\n\t\t\tconst value = cell.getValue();\n\n\t\t\tif (!value) return null;\n\n\t\t\treturn (\n\t\t\t\t<Badge className={getSeverityBgColor(value)}>\n\t\t\t\t\t{SEVERITY_MAP.has(value)\n\t\t\t\t\t\t? SEVERITY_MAP.get(value)?.toUpperCase()\n\t\t\t\t\t\t: value.toUpperCase()}\n\t\t\t\t</Badge>\n\t\t\t);\n\t\t},\n\t\tmeta: { width: '0.1fr' }\n\t}),\n\tcolumnHelper.accessor('error_msg', {\n\t\theader: 'Message',\n\t\tcell: (cell) => {\n\t\t\tconst value = cell.getValue();\n\n\t\t\tif (!value) return null;\n\n\t\t\treturn <span className=\"whitespace-pre-wrap font-mono\">{value}</span>;\n\t\t},\n\t\tmeta: { width: '1fr' }\n\t}),\n\tcolumnHelper.accessor('uri', {\n\t\tid: 'URI',\n\t\theader: 'URL',\n\t\tcell: (cell) => {\n\t\t\tconst url = cell.getValue();\n\n\t\t\tif (!z.string().url().safeParse(url).success) return null;\n\n\t\t\treturn (\n\t\t\t\t<a\n\t\t\t\t\thref={url}\n\t\t\t\t\tclassName=\"hover:underline whitespace-pre-wrap text-primary\"\n\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\trel=\"noreferrer\"\n\t\t\t\t>\n\t\t\t\t\t{url}\n\t\t\t\t</a>\n\t\t\t);\n\t\t},\n\t\tmeta: { width: '1fr' }\n\t}),\n\tcolumnHelper.display({\n\t\tid: 'expand',\n\t\tcell: ({ row }) => {\n\t\t\tconst isError =\n\t\t\t\trow.original.severity === Severity.ERROR &&\n\t\t\t\trow.original.facility === Facility.ImportRuns;\n\n\t\t\t// eslint-disable-next-line react-hooks/rules-of-hooks\n\t\t\tconst [importRuns] = useImportRunsMutation();\n\n\t\t\treturn (\n\t\t\t\t<div className=\"flex items-center gap-2 w-full justify-end\">\n\t\t\t\t\t{isError ? (\n\t\t\t\t\t\t<ButtonTw\n\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\tsize=\"xss\"\n\t\t\t\t\t\t\tonClick={async () => {\n\t\t\t\t\t\t\t\tconst promise = importRuns([\n\t\t\t\t\t\t\t\t\t{ force: true, url: row.original.uri, range: null }\n\t\t\t\t\t\t\t\t]);\n\n\t\t\t\t\t\t\t\ttoast.promise(promise, {\n\t\t\t\t\t\t\t\t\tsuccess: 'Triggered re-import successfully',\n\t\t\t\t\t\t\t\t\terror: 'Failed to trigger re-import'\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\tawait promise;\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Icon name=\"Refresh\" size={20} className=\"mr-1.5\" />\n\t\t\t\t\t\t\t<span>Try Again</span>\n\t\t\t\t\t\t</ButtonTw>\n\t\t\t\t\t) : null}\n\t\t\t\t\t<Tooltip content=\"Expand/Collapse\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t'grid place-items-center p-1 rounded-md hover:bg-primary-wash text-primary',\n\t\t\t\t\t\t\t\trow.getIsExpanded() &&\n\t\t\t\t\t\t\t\t\t'bg-primary text-white hover:text-white hover:bg-primary',\n\t\t\t\t\t\t\t\t!row.getCanExpand() && 'hidden'\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\tonClick={() => row.toggleExpanded()}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Icon\n\t\t\t\t\t\t\t\tname=\"ArrowShortTop\"\n\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t'size-5',\n\t\t\t\t\t\t\t\t\t'rotate-90',\n\t\t\t\t\t\t\t\t\trow.getIsExpanded() && 'rotate-180'\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</Tooltip>\n\t\t\t\t</div>\n\t\t\t);\n\t\t},\n\t\tmeta: { width: 'min-content' }\n\t})\n];\n","/* SPDX-License-Identifier: Apache-2.0 */\n/* SPDX-FileCopyrightText: 2021-2023 OKTET Labs Ltd. */\nimport { ComponentProps, Fragment, useState } from 'react';\nimport {\n\tExpandedState,\n\tflexRender,\n\tgetCoreRowModel,\n\tgetExpandedRowModel,\n\tgetFilteredRowModel,\n\tgetGroupedRowModel,\n\tgetPaginationRowModel,\n\tOnChangeFn,\n\tPaginationState,\n\tRow,\n\tRowData,\n\tuseReactTable\n} from '@tanstack/react-table';\nimport { format, parseISO } from 'date-fns';\nimport { RocketIcon } from '@radix-ui/react-icons';\n\nimport { Facility, LogEventWithChildren, Severity } from '@/shared/types';\nimport { getErrorMessage } from '@/services/bublik-api';\nimport {\n\tBadge,\n\tButtonTw,\n\tcn,\n\tcva,\n\tIcon,\n\tPagination,\n\tSkeleton\n} from '@/shared/tailwind-ui';\nimport { TIME_DOT_FORMAT_FULL } from '@/shared/utils';\nimport { config } from '@/bublik/config';\n\nimport {\n\tcolumns,\n\tgetBgByStatus,\n\tgetIconByStatus\n} from './import-event-table.columns';\nimport { FACILITY_MAP, SEVERITY_MAP } from '../utils';\nimport { getSeverityBgColor } from './import-event-table-utils';\nimport { useImportLog } from './import-log.component';\n\ndeclare module '@tanstack/react-table' {\n\tinterface ColumnMeta<TData extends RowData, TValue> {\n\t\twidth?: string;\n\t\tclassName?: string;\n\t}\n}\n\ninterface ImportEventTableProps {\n\tdata: LogEventWithChildren[];\n\tpagination: PaginationState;\n\tsetPagination: OnChangeFn<PaginationState>;\n\texpanded: ExpandedState;\n\tsetExpanded: OnChangeFn<ExpandedState>;\n\tisScrolled: boolean;\n\trowCount: number;\n}\n\nfunction ImportEventTable(props: ImportEventTableProps) {\n\tconst { data, pagination, setPagination, rowCount, expanded, setExpanded } =\n\t\tprops;\n\n\tconst table = useReactTable({\n\t\tstate: { pagination, expanded },\n\t\tdata,\n\t\tcolumns,\n\t\tgetCoreRowModel: getCoreRowModel(),\n\t\tgetFilteredRowModel: getFilteredRowModel(),\n\t\tgetPaginationRowModel: getPaginationRowModel(),\n\t\tgetGroupedRowModel: getGroupedRowModel(),\n\t\tgetExpandedRowModel: getExpandedRowModel(),\n\t\tonPaginationChange: setPagination,\n\t\tonExpandedChange: setExpanded,\n\t\tgetRowId: (row) => row.event_id.toString(),\n\t\tgetRowCanExpand: (row) => row?.original?.children?.length > 1,\n\t\trowCount,\n\t\tmanualPagination: true\n\t});\n\n\tconst gridTemplateColumns = columns\n\t\t.map((col) => col.meta?.['width'] || 'minmax(0, 1fr)')\n\t\t.join(' ');\n\n\treturn (\n\t\t<div>\n\t\t\t<div className=\"w-full overflow-hidden\">\n\t\t\t\t<div className=\"grid\" style={{ gridTemplateColumns }}>\n\t\t\t\t\t{table.getHeaderGroups().map((headerGroup) => (\n\t\t\t\t\t\t<Fragment key={headerGroup.id}>\n\t\t\t\t\t\t\t{headerGroup.headers.map((header) => {\n\t\t\t\t\t\t\t\tconst className = header.column.columnDef.meta?.['className'];\n\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tkey={header.id}\n\t\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\t'tracking-wider sticky top-0 mb-1 px-1 py-2 text-left text-[0.6875rem] font-semibold leading-[0.875rem] bg-white',\n\t\t\t\t\t\t\t\t\t\t\tclassName\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{header.isPlaceholder\n\t\t\t\t\t\t\t\t\t\t\t? null\n\t\t\t\t\t\t\t\t\t\t\t: flexRender(\n\t\t\t\t\t\t\t\t\t\t\t\t\theader.column.columnDef.header,\n\t\t\t\t\t\t\t\t\t\t\t\t\theader.getContext()\n\t\t\t\t\t\t\t\t\t\t\t  )}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t</Fragment>\n\t\t\t\t\t))}\n\n\t\t\t\t\t{table.getRowModel().rows.map((row) => (\n\t\t\t\t\t\t<EventRow key={row.id} row={row} />\n\t\t\t\t\t))}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div className=\"flex items-center justify-center mt-4\">\n\t\t\t\t<Pagination\n\t\t\t\t\ttotalCount={rowCount}\n\t\t\t\t\tpageSize={table.getState().pagination.pageSize}\n\t\t\t\t\tonPageChange={(page) => table.setPageIndex(page - 1)}\n\t\t\t\t\tonPageSizeChange={table.setPageSize}\n\t\t\t\t\tcurrentPage={table.getState().pagination.pageIndex + 1}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\ninterface EventRowProps {\n\trow: Row<LogEventWithChildren>;\n}\n\nfunction EventRow({ row }: EventRowProps) {\n\tconst [isHovered, setIsHovered] = useState(false);\n\tconst { toggle } = useImportLog();\n\n\treturn (\n\t\t<Fragment key={row.id}>\n\t\t\t{row.getVisibleCells().map((cell, cellIdx, cells) => {\n\t\t\t\tconst className = cell.column.columnDef.meta?.['className'];\n\n\t\t\t\treturn (\n\t\t\t\t\t<div\n\t\t\t\t\t\tkey={cell.id}\n\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t'px-1 py-2 bg-white text-text-primary whitespace-nowrap text-[0.75rem] leading-[1.125rem] font-medium',\n\t\t\t\t\t\t\t'flex items-center transition-colors',\n\t\t\t\t\t\t\t'border-transparent',\n\t\t\t\t\t\t\tcellIdx !== 0 && 'border-y',\n\t\t\t\t\t\t\tcellIdx === cells.length - 1 && 'border-r rounded-r',\n\t\t\t\t\t\t\t!row.getIsExpanded() && 'mb-1',\n\t\t\t\t\t\t\trow.getCanExpand() && 'cursor-pointer',\n\t\t\t\t\t\t\tisHovered && 'border-primary',\n\t\t\t\t\t\t\tclassName\n\t\t\t\t\t\t)}\n\t\t\t\t\t\tonMouseEnter={() => setIsHovered(true)}\n\t\t\t\t\t\tonMouseLeave={() => setIsHovered(false)}\n\t\t\t\t\t\tonClick={(e) => {\n\t\t\t\t\t\t\tconst node = e.target as HTMLElement;\n\n\t\t\t\t\t\t\tif (node.closest('a, button') || !row.getCanExpand()) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\trow.toggleExpanded();\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{flexRender(cell.column.columnDef.cell, cell.getContext())}\n\t\t\t\t\t</div>\n\t\t\t\t);\n\t\t\t})}\n\t\t\t{row.getIsExpanded() && (\n\t\t\t\t<div className={'col-span-full'}>{renderTimeline({ row, toggle })}</div>\n\t\t\t)}\n\t\t</Fragment>\n\t);\n}\n\nconst ImportEventTableLoading = () => {\n\treturn (\n\t\t<div className=\"flex flex-col gap-1 mt-1\">\n\t\t\t<Skeleton className=\"h-10\" />\n\t\t\t{Array(25)\n\t\t\t\t.fill(0)\n\t\t\t\t.map((_, idx) => (\n\t\t\t\t\t<Skeleton key={idx} className=\"rounded h-[52.5px]\" />\n\t\t\t\t))}\n\t\t</div>\n\t);\n};\n\ninterface ImportEventTableErrorProps {\n\terror: unknown;\n}\n\nconst ImportEventTableError = (props: ImportEventTableErrorProps) => {\n\tconst { description, status, title } = getErrorMessage(props.error);\n\n\treturn (\n\t\t<div className=\"flex items-center justify-center flex-grow h-screen\">\n\t\t\t<div className=\"flex items-center gap-4\">\n\t\t\t\t<Icon\n\t\t\t\t\tname=\"TriangleExclamationMark\"\n\t\t\t\t\tsize={48}\n\t\t\t\t\tclassName=\"text-text-unexpected\"\n\t\t\t\t/>\n\t\t\t\t<div className=\"flex flex-col gap-0.5\">\n\t\t\t\t\t<h2 className=\"text-2xl font-bold\">\n\t\t\t\t\t\t{status} {title}\n\t\t\t\t\t</h2>\n\t\t\t\t\t<p className=\"text-lg\">{description}</p>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nconst ImportEventTableEmpty = () => {\n\treturn (\n\t\t<div className=\"grid place-items-center h-[calc(100vh-176px)]\">\n\t\t\t<div className=\"flex flex-col items-center text-center\">\n\t\t\t\t<Icon\n\t\t\t\t\tname=\"TriangleExclamationMark\"\n\t\t\t\t\tsize={48}\n\t\t\t\t\tclassName=\"text-text-unexpected\"\n\t\t\t\t/>\n\t\t\t\t<h3 className=\"mt-2 text-sm font-medium text-gray-900\">\n\t\t\t\t\tNo results found\n\t\t\t\t</h3>\n\t\t\t\t<p className=\"mt-1 text-sm text-gray-500\">\n\t\t\t\t\tNo results found, please try another search.\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\ntype TimelineOptions = {\n\trow: Row<LogEventWithChildren>;\n\ttoggle: ReturnType<typeof useImportLog>['toggle'];\n};\n\nconst NO_TASK_GROUP = '__no-task__';\n\nfunction renderTimeline(props: TimelineOptions) {\n\tconst {\n\t\trow: {\n\t\t\toriginal: { children: events }\n\t\t},\n\t\ttoggle\n\t} = props;\n\tconst groupedEvents = events.reduce<Record<string, typeof events>>(\n\t\t(acc, evt) => {\n\t\t\tconst taskId = evt.celery_task ?? NO_TASK_GROUP;\n\t\t\tif (!acc[taskId]) acc[taskId] = [];\n\t\t\tacc[taskId].push(evt);\n\t\t\treturn acc;\n\t\t},\n\t\t{}\n\t);\n\n\treturn (\n\t\t<div className=\"bg-white px-4 py-8 border-t border-border-primary mb-1\">\n\t\t\t<div className=\"relative flex flex-col gap-8\">\n\t\t\t\t{/* Continuous vertical line across all groups */}\n\t\t\t\t<div className=\"absolute left-10 top-12 bottom-16 z-10 w-0.5 bg-border-primary\" />\n\n\t\t\t\t{Object.entries(groupedEvents).map(([taskId, taskEvents], idx, arr) => {\n\t\t\t\t\tconst isNoTask = taskId === NO_TASK_GROUP;\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tkey={taskId}\n\t\t\t\t\t\t\tclassName=\"border relative rounded-md border-border-primary p-4 hover:border-primary transition-colors\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{idx !== arr.length - 1 && (\n\t\t\t\t\t\t\t\t<div className=\"absolute left-7 top-[95%] size-6 bg-white z-0\" />\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{idx !== 0 && (\n\t\t\t\t\t\t\t\t<div className=\"absolute left-7 -top-[5%] size-6 bg-white z-0\" />\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t<div className=\"flex items-center absolute -top-[15px] px-2 left-[80px] bg-white\">\n\t\t\t\t\t\t\t\t<span className=\"text-sm text-text-primary font-semibold\">\n\t\t\t\t\t\t\t\t\tTask:\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t{isNoTask ? (\n\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t<Badge variant=\"warning\" className=\"ml-2\">\n\t\t\t\t\t\t\t\t\t\t\tNo celery task available\n\t\t\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t\t\t\t<span className=\"text-xs text-text-secondary ml-2\">\n\t\t\t\t\t\t\t\t\t\t\tThese events cannot be opened in Flower or have their logs\n\t\t\t\t\t\t\t\t\t\t\tviewed\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t<code className=\"text-sm text-gray-800 whitespace-pre-wrap\">\n\t\t\t\t\t\t\t\t\t\t\t{' '}\n\t\t\t\t\t\t\t\t\t\t\t{taskId}\n\t\t\t\t\t\t\t\t\t\t</code>\n\t\t\t\t\t\t\t\t\t\t<span className=\"px-2\">•</span>\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\n\t\t\t\t\t\t\t\t\t\t\t<ButtonTw\n\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\t\t\t\t\t\tsize=\"xss\"\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={toggle(taskId)}\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<Icon name=\"Paper\" size={20} className=\"mr-1.5\" />\n\t\t\t\t\t\t\t\t\t\t\t\t<span>Log</span>\n\t\t\t\t\t\t\t\t\t\t\t</ButtonTw>\n\t\t\t\t\t\t\t\t\t\t\t<ButtonTw\n\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\t\t\t\t\t\tsize=\"xss\"\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"justify-start\"\n\t\t\t\t\t\t\t\t\t\t\t\tasChild\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\t\t\t\thref={`${config.oldBaseUrl}/flower/task/${taskId}`}\n\t\t\t\t\t\t\t\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\t\t\t\t\t\t\t\trel=\"noreferrer\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<RocketIcon className=\"mr-1.5 size-4\" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span>Task</span>\n\t\t\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t\t\t</ButtonTw>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"relative pl-8\">\n\t\t\t\t\t\t\t\t<div className=\"space-y-4\">\n\t\t\t\t\t\t\t\t\t{taskEvents.map((evt, _) => {\n\t\t\t\t\t\t\t\t\t\tconst StatusIcon = getIconByStatus(evt.status);\n\t\t\t\t\t\t\t\t\t\tconst bg = getBgByStatus(evt.status);\n\n\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t<div key={evt.event_id} className=\"relative\">\n\t\t\t\t\t\t\t\t\t\t\t\t{/* Status icon circle */}\n\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={`absolute -left-[24px] top-[11px] flex size-8 items-center justify-center rounded-full ${bg} text-white z-10`}\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<StatusIcon className=\"size-6\" />\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t\t\t{/* Event content */}\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"space-y-3 rounded-lg ml-4 border border-border-primary bg-gray-50/70 p-4\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex flex-col gap-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<StatusBadge status={evt.status} />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FacilityBadge facility={evt.facility} />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<SeverityBadge severity={evt.severity} />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2 text-xs leading-5 text-text-primary flex-wrap\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Icon name=\"Clock\" className=\"size-4\" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{format(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tparseISO(evt.timestamp),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tTIME_DOT_FORMAT_FULL\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{evt.runtime && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span>•</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tRuntime: {formatRuntime(evt.runtime)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{evt.error_msg && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"font-medium text-xs bg-primary-wash p-4 rounded-md\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{evt.error_msg}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t);\n\t\t\t\t})}\n\t\t\t</div>\n\t\t</div>\n\t);\n}\nconst facilityStyles = cva({\n\tbase: [\n\t\t'inline-flex',\n\t\t'items-center',\n\t\t'w-fit',\n\t\t'py-0.5',\n\t\t'px-2',\n\t\t'rounded',\n\t\t'border',\n\t\t'border-transparent',\n\t\t'leading-[1.125rem]',\n\t\t'text-[0.75rem]',\n\t\t'font-medium',\n\t\t'transition-colors'\n\t],\n\tvariants: {\n\t\tvariant: {\n\t\t\t[Facility.ImportRuns]: ['bg-blue-100', 'text-blue-800'],\n\t\t\t[Facility.MetaCaterigozation]: ['bg-purple-100', 'text-purple-800'],\n\t\t\t[Facility.AddTags]: ['bg-green-100', 'text-green-800'],\n\t\t\t[Facility.Celery]: ['bg-amber-100', 'text-amber-800']\n\t\t}\n\t}\n});\n\nfunction formatRuntime(seconds: number): string {\n\tconst hrs = Math.floor(seconds / 3600);\n\tconst mins = Math.floor((seconds % 3600) / 60);\n\tconst secs = (seconds % 60).toFixed(2);\n\n\tconst parts = [];\n\tif (hrs > 0) parts.push(`${hrs}h`);\n\tif (mins > 0) parts.push(`${mins}m`);\n\tparts.push(`${secs}s`);\n\n\treturn parts.join(' ');\n}\n\ninterface FacilityBadgeProps {\n\tfacility: Facility;\n}\n\nfunction FacilityBadge(props: FacilityBadgeProps) {\n\tif (!props.facility) return null;\n\n\tconst facility = FACILITY_MAP.has(props.facility)\n\t\t? FACILITY_MAP.get(props.facility)\n\t\t: props.facility;\n\n\treturn (\n\t\t<span className={facilityStyles({ variant: props.facility })}>\n\t\t\t{facility?.toUpperCase()}\n\t\t</span>\n\t);\n}\n\ninterface SeverityBadgeProps {\n\tseverity: Severity;\n}\n\nfunction SeverityBadge(props: SeverityBadgeProps) {\n\tconst { severity } = props;\n\treturn (\n\t\t<Badge className={getSeverityBgColor(severity)}>\n\t\t\t{SEVERITY_MAP.has(severity)\n\t\t\t\t? SEVERITY_MAP.get(severity)?.toUpperCase()\n\t\t\t\t: severity.toUpperCase()}\n\t\t</Badge>\n\t);\n}\n\nexport const statusBadgeStyles = cva({\n\tbase: [\n\t\t'inline-flex',\n\t\t'w-fit',\n\t\t'px-2 py-0.5',\n\t\t'text-xs',\n\t\t'leading-5',\n\t\t'rounded',\n\t\t'items-center'\n\t],\n\tvariants: {\n\t\tvariant: {\n\t\t\tSUCCESS: ['bg-bg-ok', 'text-white'],\n\t\t\tFAILURE: ['bg-badge-12', 'text-white'],\n\t\t\tSTARTED: ['bg-primary', 'text-white'],\n\t\t\tUNKNOWN: ['bg-badge-0', 'text-text-primary']\n\t\t}\n\t},\n\tdefaultVariants: {\n\t\tvariant: 'UNKNOWN'\n\t}\n});\n\ninterface StatusBadgeProps extends ComponentProps<'div'> {\n\tstatus: string;\n}\n\nfunction StatusBadge({ status, className, ...rest }: StatusBadgeProps) {\n\treturn (\n\t\t<div\n\t\t\tclassName={cn(statusBadgeStyles({ variant: status as any }), className)}\n\t\t\t{...rest}\n\t\t>\n\t\t\t{status}\n\t\t</div>\n\t);\n}\n\nexport {\n\tImportEventTable,\n\tImportEventTableEmpty,\n\tImportEventTableLoading,\n\tImportEventTableError,\n\tFacilityBadge,\n\tStatusBadge\n};\n","/* SPDX-License-Identifier: Apache-2.0 */\n/* SPDX-FileCopyrightText: 2021-2023 OKTET Labs Ltd. */\nimport { useForm } from 'react-hook-form';\nimport { zodResolver } from '@hookform/resolvers/zod';\n\nimport { LogQuery, LogQuerySchema } from '@/shared/types';\nimport {\n\tButtonTw,\n\tDatePickerField,\n\tIcon,\n\tInput,\n\tSelectField,\n\tTooltip\n} from '@/shared/tailwind-ui';\n\nimport { facilityOptions, severityOptions } from '../utils';\nimport { BUBLIK_TAG, bublikAPI } from '@/services/bublik-api';\nimport { useDispatch } from 'react-redux';\n\nexport interface ImportRunFilterProps {\n\tonFiltersChange?: (filters: LogQuery) => void;\n\tdefaultValues?: LogQuery;\n\tonResetClick?: () => void;\n}\n\nexport const ImportRunFilterForm = (props: ImportRunFilterProps) => {\n\tconst {\n\t\tregister,\n\t\tcontrol,\n\t\thandleSubmit,\n\t\tformState: { errors }\n\t} = useForm<LogQuery>({\n\t\tdefaultValues: props.defaultValues,\n\t\tresolver: zodResolver(LogQuerySchema)\n\t});\n\tconst dispatch = useDispatch();\n\n\tconst handleInitialSubmit = () => {\n\t\treturn handleSubmit((values) => {\n\t\t\tconst severity = values.severity === 'all' ? undefined : values.severity;\n\t\t\tconst facility = values.facility === 'all' ? undefined : values.facility;\n\t\t\tdispatch(bublikAPI.util.invalidateTags([BUBLIK_TAG.importEvents]));\n\n\t\t\treturn props.onFiltersChange?.({\n\t\t\t\tseverity,\n\t\t\t\tfacility,\n\t\t\t\tdate: values.date,\n\t\t\t\tmsg: values.msg?.trim(),\n\t\t\t\ttask_id: values.task_id?.trim(),\n\t\t\t\turl: values.url?.trim()\n\t\t\t});\n\t\t});\n\t};\n\n\treturn (\n\t\t<form\n\t\t\tonSubmit={handleInitialSubmit()}\n\t\t\tclassName=\"flex flex-wrap items-center gap-4\"\n\t\t>\n\t\t\t<div>\n\t\t\t\t<SelectField\n\t\t\t\t\tname=\"severity\"\n\t\t\t\t\tplaceholder=\"Select severity\"\n\t\t\t\t\tcontrol={control}\n\t\t\t\t\tlabel=\"Severity\"\n\t\t\t\t\toptions={severityOptions}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<SelectField\n\t\t\t\t\tname=\"facility\"\n\t\t\t\t\tplaceholder=\"Select facility\"\n\t\t\t\t\tcontrol={control}\n\t\t\t\t\tlabel=\"Facility\"\n\t\t\t\t\toptions={facilityOptions}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<Input\n\t\t\t\t\tlabel=\"Message\"\n\t\t\t\t\tplaceholder=\"Message...\"\n\t\t\t\t\t{...register('msg')}\n\t\t\t\t\terror={errors.msg?.message}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<Input\n\t\t\t\t\tlabel=\"URL\"\n\t\t\t\t\tplaceholder=\"https://example.com/logs/2022/11/14/fili-mcx5-14/\"\n\t\t\t\t\t{...register('url')}\n\t\t\t\t\terror={errors.url?.message}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<Input\n\t\t\t\t\tlabel=\"Task ID\"\n\t\t\t\t\tplaceholder=\"c8a4d0b8-b3d4-4b38-9dbd-352fcd8beae0\"\n\t\t\t\t\t{...register('task_id')}\n\t\t\t\t\terror={errors.task_id?.message}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<DatePickerField label=\"Date\" name=\"date\" control={control} />\n\t\t\t</div>\n\t\t\t<div className=\"flex items-center gap-4\">\n\t\t\t\t<ButtonTw\n\t\t\t\t\tsize=\"md\"\n\t\t\t\t\trounded=\"lg\"\n\t\t\t\t\tclassName=\"justify-center\"\n\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\tvariant=\"primary\"\n\t\t\t\t>\n\t\t\t\t\t<Icon name=\"Refresh\" size={24} className=\"mr-1.5\" />\n\t\t\t\t\t<span>Submit</span>\n\t\t\t\t</ButtonTw>\n\t\t\t\t<Tooltip content=\"Reset Filters\">\n\t\t\t\t\t<ButtonTw\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\taria-label=\"Reset Form\"\n\t\t\t\t\t\tclassName=\"grid size-10 place-items-center text-text-menu hover:text-primary\"\n\t\t\t\t\t\tonClick={props.onResetClick}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Icon name=\"Bin\" size={24} />\n\t\t\t\t\t</ButtonTw>\n\t\t\t\t</Tooltip>\n\t\t\t</div>\n\t\t</form>\n\t);\n};\n","/* SPDX-License-Identifier: Apache-2.0 */\n/* SPDX-FileCopyrightText: 2021-2023 OKTET Labs Ltd. */\nimport { PropsWithChildren, useEffect, useRef, useState } from 'react';\nimport { JsonParam, useQueryParam, withDefault } from 'use-query-params';\nimport { ExpandedState, PaginationState } from '@tanstack/react-table';\n\nimport { LogQuery } from '@/shared/types';\nimport { useGetImportEventLogQuery } from '@/services/bublik-api';\n\nimport {\n\tImportEventTable,\n\tImportEventTableEmpty,\n\tImportEventTableError,\n\tImportEventTableLoading\n} from './import-event-table.component';\nimport { ImportRunFilterForm } from '../import-run-filter-form';\n\nconst FilterParams = withDefault(JsonParam, {\n\tdate: undefined,\n\tfacility: 'importruns',\n\tmsg: undefined,\n\tseverity: undefined,\n\ttask_id: undefined,\n\turl: undefined\n});\n\nconst PaginationParam = withDefault(JsonParam, {\n\tpageIndex: 0,\n\tpageSize: 25\n});\n\nfunction useImportLogPagination() {\n\tconst [pagination, setPagination] = useQueryParam<PaginationState>(\n\t\t'pagination',\n\t\tPaginationParam\n\t);\n\n\treturn { pagination, setPagination };\n}\n\nfunction useImportLogExpanded() {\n\tconst [expanded, setExpanded] = useQueryParam<ExpandedState>(\n\t\t'expanded',\n\t\tJsonParam\n\t);\n\n\treturn { expanded, setExpanded };\n}\n\nconst useEventFilters = () => {\n\tconst [params, setParams] = useQueryParam<LogQuery>('filters', FilterParams);\n\n\tconst handleFilterChange = (values: LogQuery) => {\n\t\tsetParams(values, 'replaceIn');\n\t};\n\n\tconst handleResetClick = () => {\n\t\tsetParams(\n\t\t\t{\n\t\t\t\tdate: undefined,\n\t\t\t\tfacility: 'importruns',\n\t\t\t\tmsg: undefined,\n\t\t\t\tseverity: undefined,\n\t\t\t\ttask_id: undefined,\n\t\t\t\turl: undefined\n\t\t\t},\n\t\t\t'replace'\n\t\t);\n\t};\n\n\treturn {\n\t\tquery: {\n\t\t\t...params,\n\t\t\tdate: params?.date ? new Date(params.date) : undefined\n\t\t},\n\t\tsetQuery: handleFilterChange,\n\t\tonResetClick: handleResetClick\n\t};\n};\n\nexport const ImportEventsTableContainer = (props: PropsWithChildren) => {\n\tconst { query, setQuery, onResetClick } = useEventFilters();\n\tconst { pagination, setPagination } = useImportLogPagination();\n\tconst { expanded, setExpanded } = useImportLogExpanded();\n\tconst { data, isLoading, error } = useGetImportEventLogQuery(\n\t\t{\n\t\t\t...query,\n\t\t\tpage: pagination.pageIndex + 1,\n\t\t\tpage_size: pagination.pageSize\n\t\t},\n\t\t{\n\t\t\tpollingInterval: pagination.pageIndex === 0 ? 5000 : 0,\n\t\t\trefetchOnFocus: true,\n\t\t\trefetchOnMountOrArgChange: true\n\t\t}\n\t);\n\tconst [isScrolled, setIsScrolled] = useState(false);\n\tconst containerRef = useRef<HTMLDivElement>(null);\n\n\tuseEffect(() => {\n\t\tconst container = containerRef.current;\n\t\tif (!container) return;\n\n\t\tconst handleScroll = () => {\n\t\t\tsetIsScrolled(container.scrollTop > 0);\n\t\t};\n\n\t\tcontainer.addEventListener('scroll', handleScroll);\n\t\treturn () => container.removeEventListener('scroll', handleScroll);\n\t}, []);\n\n\treturn (\n\t\t<>\n\t\t\t<div className=\"px-6 py-4 bg-white rounded-t-xl\">\n\t\t\t\t<div className=\"flex flex-wrap items-center justify-between gap-4\">\n\t\t\t\t\t<ImportRunFilterForm\n\t\t\t\t\t\tkey={JSON.stringify(query)}\n\t\t\t\t\t\tonFiltersChange={setQuery}\n\t\t\t\t\t\tdefaultValues={query}\n\t\t\t\t\t\tonResetClick={onResetClick}\n\t\t\t\t\t/>\n\t\t\t\t\t{props.children}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div className=\"flex flex-col overflow-auto flex-grow\" ref={containerRef}>\n\t\t\t\t{isLoading ? (\n\t\t\t\t\t<ImportEventTableLoading />\n\t\t\t\t) : error ? (\n\t\t\t\t\t<ImportEventTableError error={error} />\n\t\t\t\t) : data && data.results.length ? (\n\t\t\t\t\t<ImportEventTable\n\t\t\t\t\t\tdata={data.results}\n\t\t\t\t\t\tpagination={pagination}\n\t\t\t\t\t\tsetPagination={setPagination}\n\t\t\t\t\t\texpanded={expanded}\n\t\t\t\t\t\tsetExpanded={setExpanded}\n\t\t\t\t\t\trowCount={data.pagination.count}\n\t\t\t\t\t\tisScrolled={isScrolled}\n\t\t\t\t\t/>\n\t\t\t\t) : (\n\t\t\t\t\t<ImportEventTableEmpty />\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</>\n\t);\n};\n","/* SPDX-License-Identifier: Apache-2.0 */\n/* SPDX-FileCopyrightText: 2021-2023 OKTET Labs Ltd. */\nexport const stringToArray = (value: string) => {\n\treturn value.split(new RegExp('[\\\\n\\\\s]'));\n};\n","/* SPDX-License-Identifier: Apache-2.0 */\n/* SPDX-FileCopyrightText: 2021-2023 OKTET Labs Ltd. */\nimport {\n\tComponentPropsWithoutRef,\n\tforwardRef,\n\tFragment,\n\tuseCallback,\n\tuseEffect,\n\tuseImperativeHandle\n} from 'react';\nimport { z } from 'zod';\nimport {\n\tuseFieldArray,\n\tUseFieldArrayRemove,\n\tUseFieldArrayReturn,\n\tuseForm,\n\tUseFormReturn\n} from 'react-hook-form';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport { Project } from '@/services/bublik-api';\n\nimport {\n\tAriaDateRangeField,\n\tButtonTw,\n\tCheckbox,\n\tcn,\n\tDialogDescription,\n\tDialogTitle,\n\tFormAlertError,\n\tIcon,\n\tSelectInput,\n\tTextField,\n\ttoast,\n\tTooltip\n} from '@/shared/tailwind-ui';\nimport { ImportRunsFormSchema, ImportRunsFormValues } from '@/shared/types';\n\nimport { stringToArray } from './import-run-form.utils';\n\nconst DEFAULT_PROJECT_VALUE = 'default';\n\nexport interface ImportRunFormProps {\n\tonImportRunsSubmit?: (values: ImportRunsFormValues) => void;\n\tprojects: Project[];\n}\n\nconst defaultValues: ImportRunsFormValues = {\n\truns: [\n\t\t{ url: '', force: null, range: null, project: null },\n\t\t{ url: '', force: null, range: null, project: null },\n\t\t{ url: '', force: null, range: null, project: null },\n\t\t{ url: '', force: null, range: null, project: null }\n\t]\n};\n\nexport type ImportRunFormHandle = {\n\tform: UseFormReturn<ImportRunsFormValues>;\n};\n\nexport const ImportRunForm = forwardRef<\n\tImportRunFormHandle,\n\tImportRunFormProps\n>(({ onImportRunsSubmit, projects }, ref) => {\n\tconst formControl = useForm<ImportRunsFormValues>({\n\t\tdefaultValues,\n\t\tresolver: zodResolver(ImportRunsFormSchema)\n\t});\n\n\tuseImperativeHandle(ref, () => ({ form: formControl }), [formControl]);\n\n\tconst { fields, append, remove } = useFieldArray({\n\t\tname: 'runs',\n\t\tcontrol: formControl.control\n\t});\n\n\tconst handlePaste = useCallback(\n\t\t(e: ClipboardEvent) => {\n\t\t\tif ((e.target as HTMLElement).tagName === 'INPUT') return;\n\n\t\t\tconst data = e.clipboardData;\n\n\t\t\tconst text = data?.getData('text');\n\n\t\t\tif (!text) return;\n\n\t\t\tconst urlArray = stringToArray(text).filter(Boolean);\n\n\t\t\tconst isAllUrls = urlArray.every(\n\t\t\t\t(v) => z.string().url().safeParse(v).success\n\t\t\t);\n\n\t\t\tif (!isAllUrls) return toast.error('Pasted URLs are incorrect!');\n\n\t\t\te.preventDefault();\n\n\t\t\tconst parsedUrls = urlArray\n\t\t\t\t.map((v) => new URL(v))\n\t\t\t\t.map((u) => {\n\t\t\t\t\tconst urlPieces = [u.protocol, '//', u.host, u.pathname];\n\t\t\t\t\tconst url = urlPieces.join('');\n\t\t\t\t\tconst force = u.searchParams.get('force') === 'true';\n\t\t\t\t\tconst fromStr = u.searchParams.get('from');\n\t\t\t\t\tconst toStr = u.searchParams.get('to');\n\n\t\t\t\t\tif (!fromStr || !toStr) return { url, force, range: null };\n\n\t\t\t\t\tconst range = {\n\t\t\t\t\t\tstartDate: new Date(fromStr),\n\t\t\t\t\t\tendDate: new Date(toStr)\n\t\t\t\t\t};\n\n\t\t\t\t\treturn { url, force, range };\n\t\t\t\t});\n\n\t\t\tremove(fields.map((_, idx) => idx));\n\t\t\tappend(parsedUrls);\n\t\t},\n\t\t[append, fields, remove]\n\t);\n\n\tuseEffect(() => {\n\t\tdocument.addEventListener('paste', handlePaste);\n\t\treturn () => document.removeEventListener('paste', handlePaste);\n\t}, [handlePaste]);\n\n\tconst HEADER = ['URL', 'RANGE', ''];\n\n\tconst rootError = formControl.formState.errors.root?.message;\n\n\tconst handleGlobalForceChange = (checked: boolean) => {\n\t\tfields.forEach((_, idx) => {\n\t\t\tformControl.setValue(`runs.${idx}.force`, checked);\n\t\t});\n\t};\n\n\tconst handleProjectFieldChange = (value: string) => {\n\t\tfields.forEach((_, idx) => {\n\t\t\tif (value === DEFAULT_PROJECT_VALUE) {\n\t\t\t\tformControl.setValue(`runs.${idx}.project`, null);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tformControl.setValue(`runs.${idx}.project`, parseInt(value));\n\t\t});\n\t};\n\n\tconst allForceEnabled =\n\t\tfields.length > 0 &&\n\t\tfields.every((_, index) => {\n\t\t\tconst value = formControl.watch(`runs.${index}.force`);\n\t\t\treturn value === true;\n\t\t});\n\n\tconst projectOptions = [\n\t\t{\n\t\t\tvalue: DEFAULT_PROJECT_VALUE,\n\t\t\tdisplayValue: 'No Project (Default)'\n\t\t},\n\t\t...projects.map((project) => ({\n\t\t\tvalue: project.id.toString(),\n\t\t\tdisplayValue: project.name\n\t\t}))\n\t];\n\n\tconst runs = formControl.watch('runs');\n\n\tconst uniqueProjects = new Set(\n\t\truns.map((run) => run.project?.toString() ?? DEFAULT_PROJECT_VALUE)\n\t);\n\n\tconst projectValue =\n\t\tuniqueProjects.size === 1 ? [...uniqueProjects][0] : DEFAULT_PROJECT_VALUE;\n\n\treturn (\n\t\t<>\n\t\t\t<DialogTitle className=\"text-lg font-semibold leading-none tracking-tight\">\n\t\t\t\tImport Runs\n\t\t\t</DialogTitle>\n\t\t\t{rootError ? (\n\t\t\t\t<FormAlertError title={'Error'} description={rootError} />\n\t\t\t) : null}\n\t\t\t<form\n\t\t\t\tclassName=\"flex flex-col gap-4 mt-2\"\n\t\t\t\tonSubmit={formControl.handleSubmit((form) =>\n\t\t\t\t\tonImportRunsSubmit?.({\n\t\t\t\t\t\t...form,\n\t\t\t\t\t\truns: form.runs.filter((v) => v.url)\n\t\t\t\t\t})\n\t\t\t\t)}\n\t\t\t>\n\t\t\t\t<SelectInput\n\t\t\t\t\tlabel=\"Project\"\n\t\t\t\t\toptions={projectOptions}\n\t\t\t\t\tvalue={projectValue}\n\t\t\t\t\tonValueChange={handleProjectFieldChange}\n\t\t\t\t/>\n\t\t\t\t<p className=\"text-gray-500 text-sm leading-relaxed font-normal space-y-1\">\n\t\t\t\t\t<span>\n\t\t\t\t\t\tRun must be linked to a project. If it isn’t, the import will fail.{' '}\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\tYou can link it here in the import form or in the run’s\n\t\t\t\t\t\t<code className=\"mx-1 bg-gray-100 px-1 py-0.5 rounded text-gray-700\">\n\t\t\t\t\t\t\tmeta_data.json\n\t\t\t\t\t\t</code>\n\t\t\t\t\t\t.\n\t\t\t\t\t\t<br />\n\t\t\t\t\t</span>\n\t\t\t\t\t<span className=\"font-medium text-gray-600\">Precedence order:</span>\n\t\t\t\t\t<ol className=\"list-decimal list-inside mt-1 space-y-0.5\">\n\t\t\t\t\t\t<li>Project specified in the import form</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\tProject specified in{' '}\n\t\t\t\t\t\t\t<code className=\"bg-gray-100 px-1 py-0.5 rounded text-gray-700\">\n\t\t\t\t\t\t\t\tmeta_data.json\n\t\t\t\t\t\t\t</code>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ol>\n\t\t\t\t</p>\n\n\t\t\t\t<div className=\"flex flex-col gap-4\">\n\t\t\t\t\t<div className=\"grid grid-cols-[1fr,min-content,min-content] gap-y-2 gap-x-2\">\n\t\t\t\t\t\t{HEADER.map((label) => (\n\t\t\t\t\t\t\t<HeaderCell key={label}>{label}</HeaderCell>\n\t\t\t\t\t\t))}\n\t\t\t\t\t\t{fields.map((field, idx) => (\n\t\t\t\t\t\t\t<EditRow\n\t\t\t\t\t\t\t\tidx={idx}\n\t\t\t\t\t\t\t\tkey={field.id}\n\t\t\t\t\t\t\t\tfield={field}\n\t\t\t\t\t\t\t\tformApi={formControl}\n\t\t\t\t\t\t\t\tremove={remove}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t\t<ButtonTw\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\trounded=\"lg\"\n\t\t\t\t\t\tsize=\"md\"\n\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\tonClick={() =>\n\t\t\t\t\t\t\tappend({ url: '', force: false, range: null, project: null })\n\t\t\t\t\t\t}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Icon name=\"AddSymbol\" size={24} className=\"mr-1.5 text-primary\" />\n\t\t\t\t\t\t<span>Add</span>\n\t\t\t\t\t</ButtonTw>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"flex items-center gap-1\">\n\t\t\t\t\t<Checkbox\n\t\t\t\t\t\tid=\"force-import\"\n\t\t\t\t\t\tchecked={allForceEnabled}\n\t\t\t\t\t\tonCheckedChange={handleGlobalForceChange}\n\t\t\t\t\t\taria-label=\"Force import for all runs\"\n\t\t\t\t\t/>\n\t\t\t\t\t<label htmlFor=\"force-import\" className=\"text-sm font-medium\">\n\t\t\t\t\t\tForce Import\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<ButtonTw\n\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\trounded=\"lg\"\n\t\t\t\t\t\tsize=\"md\"\n\t\t\t\t\t\tvariant=\"primary\"\n\t\t\t\t\t\tclassName=\"w-full\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{formControl.formState.isSubmitting ? (\n\t\t\t\t\t\t\t<Icon name=\"ProgressIndicator\" className=\"pr-2\" />\n\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t{formControl.formState.isSubmitting\n\t\t\t\t\t\t\t? 'Importing...'\n\t\t\t\t\t\t\t: 'Start Import'}\n\t\t\t\t\t</ButtonTw>\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t</>\n\t);\n});\n\nconst HeaderCell = ({\n\tclassName,\n\tchildren,\n\t...props\n}: ComponentPropsWithoutRef<'div'>) => {\n\treturn (\n\t\t<div className={cn('grid items-center', className)} {...props}>\n\t\t\t<span className=\"text-xs font-bold tracking-wider uppercase\">\n\t\t\t\t{children}\n\t\t\t</span>\n\t\t</div>\n\t);\n};\n\nconst BodyCell = ({\n\tclassName,\n\tchildren,\n\t...props\n}: ComponentPropsWithoutRef<'div'>) => {\n\treturn (\n\t\t<div className={cn('grid items-center', className)} {...props}>\n\t\t\t{children}\n\t\t</div>\n\t);\n};\n\ntype EditRowProps = {\n\tidx: number;\n\tfield: UseFieldArrayReturn<ImportRunsFormValues>['fields'][number];\n\tremove: UseFieldArrayRemove;\n\tformApi: UseFormReturn<ImportRunsFormValues>;\n};\n\nconst EditRow = ({ field, idx, formApi, remove }: EditRowProps) => {\n\treturn (\n\t\t<Fragment key={field.id}>\n\t\t\t<BodyCell>\n\t\t\t\t<TextField\n\t\t\t\t\tcontrol={formApi.control}\n\t\t\t\t\tname={`runs.${idx}.url`}\n\t\t\t\t\tplaceholder={`https://ts-factory.io/logs/2022/11/14/fili-mcx5-${\n\t\t\t\t\t\tidx + 1\n\t\t\t\t\t}`}\n\t\t\t\t\tautoFocus={idx === 0}\n\t\t\t\t/>\n\t\t\t</BodyCell>\n\t\t\t<BodyCell>\n\t\t\t\t<AriaDateRangeField\n\t\t\t\t\tname={`runs.${idx}.range`}\n\t\t\t\t\tcontrol={formApi.control}\n\t\t\t\t\tlabel=\"Range\"\n\t\t\t\t\thideLabel\n\t\t\t\t/>\n\t\t\t</BodyCell>\n\t\t\t<BodyCell className=\"grid place-items-center\">\n\t\t\t\t{idx !== 0 ? (\n\t\t\t\t\t<Tooltip content=\"Delete row\">\n\t\t\t\t\t\t<ButtonTw\n\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t\tonClick={() => remove(idx)}\n\t\t\t\t\t\t\tclassName=\"grid rounded size-10 text-text-unexpected hover:bg-red-100 place-items-center\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Icon name=\"CrossSimple\" size={24} />\n\t\t\t\t\t\t</ButtonTw>\n\t\t\t\t\t</Tooltip>\n\t\t\t\t) : null}\n\t\t\t</BodyCell>\n\t\t</Fragment>\n\t);\n};\n","/* SPDX-License-Identifier: Apache-2.0 */\n/* SPDX-FileCopyrightText: 2021-2023 OKTET Labs Ltd. */\nimport { PropsWithChildren } from 'react';\n\nimport {\n\tDialog,\n\tDialogTrigger,\n\tModalContent,\n\tButtonTw,\n\tTwScrollArea,\n\tIcon,\n\tTooltip,\n\tDialogClose\n} from '@/shared/tailwind-ui';\n\ninterface ImportRunFormModalProps {\n\tonClose?: () => void;\n}\n\nfunction ImportRunFormModal(props: PropsWithChildren<ImportRunFormModalProps>) {\n\tconst handleOpenChange = (open: boolean) => {\n\t\tif (!open) setTimeout(() => props.onClose?.(), 300);\n\t};\n\n\treturn (\n\t\t<Dialog onOpenChange={handleOpenChange}>\n\t\t\t<DialogTrigger asChild>\n\t\t\t\t<ButtonTw variant=\"outline\" size=\"md\" rounded=\"lg\">\n\t\t\t\t\t<Icon name=\"FilePlus\" size={24} className=\"mr-1.5 text-primary\" />\n\t\t\t\t\t<span>Import</span>\n\t\t\t\t</ButtonTw>\n\t\t\t</DialogTrigger>\n\n\t\t\t<ModalContent className=\"min-w-[1000px]\">\n\t\t\t\t<TwScrollArea className=\"bg-white max-h-[85vh] rounded-lg p-6\">\n\t\t\t\t\t<Tooltip content=\"Close\">\n\t\t\t\t\t\t<DialogClose asChild>\n\t\t\t\t\t\t\t<ButtonTw\n\t\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t\t\tclassName=\"absolute top-4 right-4 p-1.5 hover:text-primary text-text-menu\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Icon name=\"Cross\" size={14} />\n\t\t\t\t\t\t\t</ButtonTw>\n\t\t\t\t\t\t</DialogClose>\n\t\t\t\t\t</Tooltip>\n\t\t\t\t\t<div className=\"flex-1 flex flex-col gap-4\">{props.children}</div>\n\t\t\t\t</TwScrollArea>\n\t\t\t</ModalContent>\n\t\t</Dialog>\n\t);\n}\n\nexport { ImportRunFormModal, type ImportRunFormModalProps };\n","/* SPDX-License-Identifier: Apache-2.0 */\n/* SPDX-FileCopyrightText: 2021-2023 OKTET Labs Ltd. */\nimport { format } from 'date-fns';\nimport { RocketIcon } from '@radix-ui/react-icons';\n\nimport { config } from '@/bublik/config';\nimport { ImportEventResponse } from '@/shared/types';\nimport {\n\tButtonTw,\n\tDialogDescription,\n\tDialogTitle,\n\tIcon\n} from '@/shared/tailwind-ui';\n\nimport { useImportLog } from '../import-events-table';\nimport { StatusBadge } from '../import-events-table/import-event-table.component';\n\ninterface RunImportResultProps {\n\tresults: ImportEventResponse[];\n\ttimestamp?: Date;\n}\n\nfunction RunImportResult({\n\tresults,\n\ttimestamp = new Date()\n}: RunImportResultProps) {\n\tconst { toggle } = useImportLog();\n\n\treturn (\n\t\t<div>\n\t\t\t<DialogTitle className=\"text-lg font-semibold leading-none tracking-tight\">\n\t\t\t\tImport Runs\n\t\t\t</DialogTitle>\n\n\t\t\t<DialogDescription className=\"mt-1.5 text-base text-gray-500\">\n\t\t\t\tScheduled runs will be imported in the background\n\t\t\t</DialogDescription>\n\t\t\t<p className=\"mt-1.5 mb-6 text-sm text-gray-500\">\n\t\t\t\tYou can check the logs and flower tasks\n\t\t\t</p>\n\t\t\t<h3 className=\"text-sm font-medium text-text-primary mb-2\">Imports</h3>\n\t\t\t<ul className=\"border rounded-md [&>*:not(:last-child)]:border-b [&>*]:border-border-primary\">\n\t\t\t\t{results.map((result, i) => {\n\t\t\t\t\tconst url = result.url ? new URL(result.url) : null;\n\t\t\t\t\tconst cleanUrl = url ? url.origin + url.pathname : '';\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<li key={i} className=\"space-y-2 p-4\">\n\t\t\t\t\t\t\t<div className=\"flex items-center justify-between gap-2\">\n\t\t\t\t\t\t\t\t<StatusBadge status={result.taskId ? 'SUCCESS' : 'FAILURE'} />\n\t\t\t\t\t\t\t\t<span className=\"text-xs text-gray-500\">\n\t\t\t\t\t\t\t\t\t{format(\n\t\t\t\t\t\t\t\t\t\tnew Date(\n\t\t\t\t\t\t\t\t\t\t\ttimestamp.getTime() -\n\t\t\t\t\t\t\t\t\t\t\t\ttimestamp.getTimezoneOffset() * 60000\n\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t'hh:mm a'\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{cleanUrl ? (\n\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\thref={cleanUrl}\n\t\t\t\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\t\t\t\tclassName=\"rounded-md bg-primary-wash p-2 text-sm font-mono block hover:underline\"\n\t\t\t\t\t\t\t\t\trel=\"noreferrer\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{cleanUrl}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\t<div className=\"flex gap-2\">\n\t\t\t\t\t\t\t\t<ButtonTw\n\t\t\t\t\t\t\t\t\tvariant=\"outline-secondary\"\n\t\t\t\t\t\t\t\t\tonClick={\n\t\t\t\t\t\t\t\t\t\tresult.taskId ? toggle(result.taskId, true) : undefined\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tclassName=\"flex-1\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Icon name=\"Paper\" size={20} className=\"mr-1.5\" />\n\t\t\t\t\t\t\t\t\t<span>Log</span>\n\t\t\t\t\t\t\t\t</ButtonTw>\n\t\t\t\t\t\t\t\t<ButtonTw\n\t\t\t\t\t\t\t\t\tvariant=\"outline-secondary\"\n\t\t\t\t\t\t\t\t\tclassName=\"flex-1\"\n\t\t\t\t\t\t\t\t\tasChild\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\thref={`${config.oldBaseUrl}/flower/task/${result.taskId}`}\n\t\t\t\t\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\t\t\t\t\trel=\"noreferrer\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<RocketIcon className=\"size-4 mr-1.5\" />\n\t\t\t\t\t\t\t\t\t\t<span>Task</span>\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</ButtonTw>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t);\n\t\t\t\t})}\n\t\t\t</ul>\n\t\t</div>\n\t);\n}\n\nexport { RunImportResult, type RunImportResultProps };\n","/* SPDX-License-Identifier: Apache-2.0 */\n/* SPDX-FileCopyrightText: 2021-2023 OKTET Labs Ltd. */\nimport { useRef, useState } from 'react';\nimport { z } from 'zod';\n\nimport { ImportEventResponse, ImportRunsFormValues } from '@/shared/types';\nimport { bublikAPI, useImportRunsMutation } from '@/services/bublik-api';\nimport { setErrorsOnForm } from '@/shared/utils';\n\nimport {\n\tImportRunForm,\n\tImportRunFormHandle\n} from './import-run-form.component';\nimport { ImportRunFormModal } from './import-run-form-modal.component';\nimport { RunImportResult } from './import-run-form-result-list.component';\n\ntype FormState = 'form' | 'result';\n\nexport const useImportTasks = () => {\n\tconst [importRuns] = useImportRunsMutation();\n\tconst [step, setStep] = useState<FormState>('form');\n\tconst [celeryTasks, setCeleryTasks] = useState<ImportEventResponse[]>([]);\n\tconst importFormRef = useRef<ImportRunFormHandle>(null);\n\n\tconst onFormSubmit = async ({ runs }: ImportRunsFormValues) => {\n\t\tconst form = importFormRef.current?.form;\n\t\tif (!form) return;\n\n\t\ttry {\n\t\t\tconst onlyUrls = runs.filter(\n\t\t\t\t(run) => z.string().url().safeParse(run.url).success\n\t\t\t);\n\n\t\t\tif (!onlyUrls.length) {\n\t\t\t\tform.setError('root', {\n\t\t\t\t\tmessage: 'You must enter at least one valid URL'\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst results = await importRuns(onlyUrls).unwrap();\n\n\t\t\tsetStep('result');\n\t\t\tsetCeleryTasks(results);\n\t\t} catch (e: unknown) {\n\t\t\tsetErrorsOnForm(e, { handle: form });\n\t\t}\n\t};\n\n\tconst onFormClose = () => {\n\t\tsetStep('form');\n\t\tsetCeleryTasks([]);\n\t};\n\n\treturn { step, onFormClose, onFormSubmit, celeryTasks, importFormRef };\n};\n\nexport const ImportRunFormContainer = () => {\n\tconst { step, onFormClose, onFormSubmit, celeryTasks, importFormRef } =\n\t\tuseImportTasks();\n\tconst { data, error, isLoading } = bublikAPI.useGetAllProjectsQuery();\n\n\treturn (\n\t\t<ImportRunFormModal onClose={onFormClose}>\n\t\t\t{step === 'form' && !error && !isLoading && data && (\n\t\t\t\t<ImportRunForm\n\t\t\t\t\tprojects={data}\n\t\t\t\t\tonImportRunsSubmit={onFormSubmit}\n\t\t\t\t\tref={importFormRef}\n\t\t\t\t/>\n\t\t\t)}\n\t\t\t{step === 'result' && <RunImportResult results={celeryTasks} />}\n\t\t</ImportRunFormModal>\n\t);\n};\n","/* SPDX-License-Identifier: Apache-2.0 */\n/* SPDX-FileCopyrightText: 2021-2023 OKTET Labs Ltd. */\nimport { useTabTitleWithPrefix } from '@/bublik/features/projects';\nimport {\n\tImportEventsTableContainer,\n\tImportLogProvider,\n\tImportRunFormContainer\n} from '@/bublik/features/run-import';\n\nexport const ImportPage = () => {\n\tuseTabTitleWithPrefix('Import - Bublik');\n\n\treturn (\n\t\t<div className=\"p-2 overflow-hidden h-full\">\n\t\t\t<div className=\"flex flex-col gap-1 h-full\">\n\t\t\t\t<ImportLogProvider>\n\t\t\t\t\t<ImportEventsTableContainer>\n\t\t\t\t\t\t<ImportRunFormContainer />\n\t\t\t\t\t</ImportEventsTableContainer>\n\t\t\t\t</ImportLogProvider>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n"],"names":["SelectField","props","field","useController","jsx","SelectInput","SEVERITY_MAP","Severity","FACILITY_MAP","Facility","severityOptions","value","displayValue","facilityOptions","getSeverityBgColor","severity","ImportLogContext","createContext","useImportLog","context","useContext","ImportLogProvider","children","taskId","setTaskId","useQueryParam","StringParam","enablePolling","setEnablePolling","withDefault","BooleanParam","toggle","task","t","close","JsonLogContainer","DrawerRoot","open","DialogPortal","DrawerContent","ImportLogTableContainer","getRunIdFromLogs","data","patterns","entry","pattern","match","BG_CLASS","isAtBottom","setIsAtBottom","useState","shouldPoll","setShouldPoll","textWrap","setTextWrap","useLocalStorage","isLoading","isFetching","error","useGetImportLogQuery","skipToken","scrollRef","useRef","copy","useCopyToClipboard","toast","handleScroll","useCallback","el","isBottom","useEffect","ImportLogError","Skeleton","maybeRunId","showPausedChip","jsxs","Fragment","CardHeader","Spinner","HeaderLinks","ButtonTw","config","RocketIcon","d","Icon","v","DialogClose","AnimatePresence","motion","PauseIcon","cn","ImportLogTable","status","title","description","getErrorMessage","Tooltip","runId","LinkWithProject","routes","helper","createColumnHelper","getColumns","row","info","getRowClassName","level","baseClasses","logs","table","useReactTable","getCoreRowModel","group","header","flexRender","cell","className","getBgByStatus","getIconByStatus","columnHelper","ActionsCell","columns","date","formatTimeToDot","facility","FacilityBadge","Badge","url","z","isError","importRuns","useImportRunsMutation","promise","ImportEventTable","pagination","setPagination","rowCount","expanded","setExpanded","getFilteredRowModel","getPaginationRowModel","getGroupedRowModel","getExpandedRowModel","gridTemplateColumns","col","headerGroup","EventRow","Pagination","page","isHovered","setIsHovered","cellIdx","cells","e","renderTimeline","ImportEventTableLoading","_","idx","ImportEventTableError","ImportEventTableEmpty","NO_TASK_GROUP","events","groupedEvents","acc","evt","taskEvents","arr","isNoTask","StatusIcon","bg","StatusBadge","SeverityBadge","format","parseISO","TIME_DOT_FORMAT_FULL","formatRuntime","facilityStyles","cva","seconds","hrs","mins","secs","parts","statusBadgeStyles","rest","ImportRunFilterForm","register","control","handleSubmit","errors","useForm","zodResolver","LogQuerySchema","dispatch","useDispatch","handleInitialSubmit","values","bublikAPI","BUBLIK_TAG","Input","DatePickerField","FilterParams","JsonParam","PaginationParam","useImportLogPagination","useImportLogExpanded","useEventFilters","params","setParams","handleFilterChange","handleResetClick","ImportEventsTableContainer","query","setQuery","onResetClick","useGetImportEventLogQuery","isScrolled","setIsScrolled","containerRef","container","stringToArray","DEFAULT_PROJECT_VALUE","defaultValues","ImportRunForm","forwardRef","onImportRunsSubmit","projects","ref","formControl","ImportRunsFormSchema","useImperativeHandle","fields","append","remove","useFieldArray","handlePaste","text","urlArray","parsedUrls","u","force","fromStr","toStr","range","HEADER","rootError","handleGlobalForceChange","checked","handleProjectFieldChange","allForceEnabled","index","projectOptions","project","runs","uniqueProjects","run","projectValue","DialogTitle","FormAlertError","form","label","HeaderCell","EditRow","Checkbox","BodyCell","formApi","TextField","AriaDateRangeField","ImportRunFormModal","handleOpenChange","Dialog","DialogTrigger","ModalContent","TwScrollArea","RunImportResult","results","timestamp","DialogDescription","result","i","cleanUrl","useImportTasks","step","setStep","celeryTasks","setCeleryTasks","importFormRef","onlyUrls","setErrorsOnForm","ImportRunFormContainer","onFormClose","onFormSubmit","ImportPage","useTabTitleWithPrefix"],"mappings":"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"}