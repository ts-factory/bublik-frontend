import{j as e}from"./shiki-CtY5KH0E.js";import{a as C,L as _}from"./react-BSMx3yqy.js";import{C as k,o as I,i as R,b6 as D,aq as q,ar as Q,I as N,as as S,b7 as E,b8 as H,b9 as y,ba as T,b as P,w,bb as F,bc as O,j as A,r as L}from"./index-rCMhFuXx.js";import{E as V,S as z,I as J}from"./selected-charts.component-CqeB5_H5.js";import{u as B,r as K,a as U,b as G,c as W}from"./plot-list.utils-DR9VGL6l.js";import"./reactJsonView-KCeSiE7A.js";import"./echarts-lseLLy92.js";import"./monaco-CdFZwoqU.js";import"./prettier-BE4rBlSX.js";const X=a=>{const{idx:t,plot:l,parameters:n,combinedState:s,onAddChartClick:c,enableResultErrorHighlight:d,group:m,selectedGroup:u}=a,[p,h]=C.useState(!1),[i,b]=C.useState(null),x=async j=>{const{dataIndex:v}=j,r=K(l,v);r&&(h(!0),b(r))},f=j=>{c({plot:j,color:S(t),group:m,parameters:n})},g=s==="disabled"||u!==null&&u!==m;return e.jsxs(e.Fragment,{children:[i&&e.jsx(D,{runId:i.run_id,resultId:i.result_id,measurementId:i.result_id,open:p,onOpenChange:h}),e.jsx("li",{className:"py-2.5 px-4",children:e.jsx(q,{chart:l,color:S(t),onChartPointClick:x,enableResultErrorHighlight:d,additionalToolBarItems:e.jsx(Q,{"aria-label":"Add to combined chart",state:g?"disabled":s==="active"?"active":"default",disabled:g,onClick:()=>f(l),children:e.jsx(N,{name:"AddSymbol",className:"size-5"})})})})]})},M=a=>{const{label:t}=a;return e.jsxs("div",{className:"bg-white rounded-md",children:[e.jsx(k,{label:t,children:e.jsx("div",{className:"flex items-stretch h-full gap-4",children:e.jsx(R,{className:"w-[75px] h-full rounded"})})}),e.jsx("ul",{className:"chart-mosaic",children:Array.from({length:6}).map((l,n)=>e.jsx("li",{className:"py-2.5 px-4",children:e.jsx(R,{className:"h-[334px] rounded"})},n))})]})};function $(a){const{plots:t,isFetching:l,label:n,enableResultErrorHighlight:s,group:c,parameters:d}=a,{handleAddChartClick:m,selectedCharts:u,selectedGroup:p}=B();return e.jsxs("div",{className:I("bg-white rounded-md",l&&"pointer-events-none opacity-60"),children:[e.jsx("div",{className:"bg-white rounded-md",children:e.jsx(k,{label:n,children:e.jsx("div",{className:"flex items-stretch gap-4",children:e.jsx(V,{plots:t})})})}),e.jsx("ul",{className:I("[&>li]:border-b [&>li]:border-border-primary",t.length!==1&&"min-[1465px]:chart-mosaic"),children:t.map((h,i)=>{const b=String(h.id),x=u.length?u.find(({plot:f})=>String(f.id)===b)?"active":"waiting":"default";return e.jsx(X,{idx:i,plot:h,onAddChartClick:m,combinedState:x,parameters:d,enableResultErrorHighlight:s,group:c,selectedGroup:p},`${i}_${b}`)})})]})}function oe(){const{query:a}=E(),{data:t,isLoading:l,isFetching:n,error:s}=U(),c=H();G(a?.testName);const d=()=>{c.toggleIsGlobalSearchOpen(!0)},{handleRemoveClick:m,handleResetButtonClick:u,selectedCharts:p,handleOpenButtonClick:h,syncChartsFromData:i}=B();return C.useEffect(()=>{t&&i(t)},[t,i]),a.testName?s?e.jsx(T,{error:s,onButtonClick:d}):l?e.jsx(M,{label:"Trend Charts"}):t?.length?e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx($,{label:"Trend Charts",plots:t,isFetching:n,enableResultErrorHighlight:!0,group:"trend"}),e.jsx(z,{open:!!p.length,label:"Combined",plots:p,onResetButtonClick:u,onRemoveClick:m,onOpenButtonClick:h})]}):e.jsx(y,{type:"no-results",onOpenFormClick:d}):e.jsx(y,{type:"no-test-name",onOpenFormClick:d})}function ce(){const{query:a}=E(),{data:t,isLoading:l,error:n}=W(),s=H();G(a?.testName);const c=()=>{s.toggleIsGlobalSearchOpen(!0)},{handleRemoveClick:d,handleResetButtonClick:m,selectedCharts:u,handleOpenButtonClick:p,syncChartsFromData:h}=B();C.useEffect(()=>{if(!t)return;const r=t.flatMap(o=>o.measurement_series_charts);h(r)},[t,h]);const i=C.useMemo(()=>Array.from(new Set(t?.map(o=>o.parameters_list).flat())??[]).sort().map(o=>({label:o,value:o})),[t]),b=C.useMemo(()=>Array.from(new Set(t?.map(r=>r.measurement_series_charts.map(o=>`${o.title} - ${o.axis_y.label}`)).flat())??[]).sort().map(r=>({label:r,value:r})),[t]),[x=[],f]=P("parametersByResultFilter",w(F,[]),{updateType:"replaceIn"}),[g=[],j]=P("parametersByResultName",w(F,[]),{updateType:"replaceIn"});if(!a.testName)return e.jsx(y,{type:"no-test-name",onOpenFormClick:c});if(n)return e.jsx(T,{error:n,onButtonClick:c});if(l)return e.jsx(M,{label:"Series Charts"});if(!t?.length)return e.jsx(y,{type:"no-results",onOpenFormClick:c});const v=t.filter(r=>!x||!x.length?!0:x.every(o=>typeof o=="string"&&r.parameters_list.includes(o)));return e.jsxs("div",{className:"bg-white rounded-md",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-white rounded-md",children:e.jsx(k,{label:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-text-primary text-[0.75rem] font-semibold leading-[0.875rem]",children:"Series Charts"}),e.jsx(O,{size:"xss",title:"Charts",value:g.filter(r=>typeof r=="string")??[],onChange:j,options:b}),e.jsx(O,{size:"xss",title:"Parameters",value:x.filter(r=>typeof r=="string")??[],onChange:f,options:i})]}),enableStickyShadow:!0})}),e.jsx(Y,{measurements:v,nameFilter:g.filter(r=>typeof r=="string")??[],group:"measurement"}),e.jsx(z,{open:!!u.length,label:"Combined",plots:u,onResetButtonClick:m,onRemoveClick:d,onOpenButtonClick:p})]})}function Y(a){const{measurements:t,group:l,nameFilter:n=[]}=a;return e.jsx("div",{className:"flex flex-col",children:t.map((s,c)=>{const d=n.length>0?s.measurement_series_charts.filter(m=>n?.includes(`${m.title} - ${m.axis_y.label}`)):s.measurement_series_charts;return e.jsxs("div",{className:"[&:not(:last-child)]:border-b border-border-primary",children:[e.jsx(k,{label:s.test_name,children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(A,{variant:"secondary",size:"xss",asChild:!0,children:e.jsxs(_,{to:L.run({runId:s.run_id}),children:[e.jsx(N,{name:"BoxArrowRight",size:20,className:"mr-1.5"}),e.jsx("span",{children:"Run"})]})}),e.jsx(A,{variant:"secondary",size:"xss",asChild:!0,children:e.jsxs(_,{to:L.measurements({runId:s.run_id,resultId:s.result_id}),children:[e.jsx(N,{name:"BoxArrowRight",size:20,className:"mr-1.5"}),e.jsx("span",{children:"Result"})]})})]})}),e.jsx("div",{className:"py-2.5 px-4 border-b border-border-primary",children:e.jsx(J,{name:s.test_name,start:s.start,parameters:s.parameters_list})}),s.measurement_series_charts.length?e.jsx($,{label:"Charts",plots:d,parameters:s.parameters_list,group:l}):null]},`${c}-${s.id}`)})})}export{$ as PlotList,oe as PlotListContainer,ce as PlotListContainerByResult,M as PlotListLoading};
//# sourceMappingURL=index-CTXipCY_.js.map
