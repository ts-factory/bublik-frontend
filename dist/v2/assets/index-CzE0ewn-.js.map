{"version":3,"file":"index-CzE0ewn-.js","sources":["../../../bublik-ui/libs/bublik/features/history/src/lib/history-measurements/plot-list.component.tsx","../../../bublik-ui/libs/bublik/features/history/src/lib/history-measurements/plot-list.container.tsx"],"sourcesContent":["/* SPDX-License-Identifier: Apache-2.0 */\n/* SPDX-FileCopyrightText: 2021-2023 OKTET Labs Ltd. */\nimport { useState } from 'react';\n\nimport { Point } from '@/shared/types';\nimport {\n\tCardHeader,\n\tcn,\n\tIcon,\n\tSkeleton,\n\tToolbarButton\n} from '@/shared/tailwind-ui';\nimport { ExportChart, getColorByIdx, MeasurementChart } from '@/shared/charts';\nimport { SingleMeasurementChart } from '@/services/bublik-api';\nimport { LogPreviewContainer } from '@/bublik/features/log-preview-drawer';\n\nimport { useCombinedView } from './plot-list.hooks';\nimport { resolvePoint } from './plot-list.utils';\n\ninterface PlotListItemProps {\n\tidx: number;\n\tplot: SingleMeasurementChart;\n\tparameters?: string[];\n\tonAddChartClick: (args: {\n\t\tplot: SingleMeasurementChart;\n\t\tcolor: string;\n\t\tgroup: 'trend' | 'measurement';\n\t\tparameters?: string[];\n\t}) => void;\n\tcombinedState: 'disabled' | 'active' | 'default' | 'waiting';\n\tenableResultErrorHighlight?: boolean;\n\tgroup: 'trend' | 'measurement';\n\tselectedGroup: 'trend' | 'measurement' | null;\n}\n\nconst PlotListItem = (props: PlotListItemProps) => {\n\tconst {\n\t\tidx,\n\t\tplot,\n\t\tparameters,\n\t\tcombinedState,\n\t\tonAddChartClick,\n\t\tenableResultErrorHighlight,\n\t\tgroup,\n\t\tselectedGroup\n\t} = props;\n\tconst [isDialogOpen, setIsDialogOpen] = useState(false);\n\tconst [point, setPoint] = useState<Point | null>(null);\n\n\tconst handleChartPointClick = async (opts: { dataIndex: number }) => {\n\t\tconst { dataIndex } = opts;\n\t\tconst point = resolvePoint(plot, dataIndex);\n\n\t\tif (!point) return;\n\n\t\tsetIsDialogOpen(true);\n\t\tsetPoint(point);\n\t};\n\n\tconst handleChartAddClick = (plot: SingleMeasurementChart) => {\n\t\tonAddChartClick({ plot, color: getColorByIdx(idx), group, parameters });\n\t};\n\n\tconst isDisabled =\n\t\tcombinedState === 'disabled' ||\n\t\t(selectedGroup !== null && selectedGroup !== group);\n\n\treturn (\n\t\t<>\n\t\t\t{point && (\n\t\t\t\t<LogPreviewContainer\n\t\t\t\t\trunId={point.run_id}\n\t\t\t\t\tresultId={point.result_id}\n\t\t\t\t\tmeasurementId={point.result_id}\n\t\t\t\t\topen={isDialogOpen}\n\t\t\t\t\tonOpenChange={setIsDialogOpen}\n\t\t\t\t/>\n\t\t\t)}\n\t\t\t<li className=\"py-2.5 px-4\">\n\t\t\t\t<MeasurementChart\n\t\t\t\t\tchart={plot}\n\t\t\t\t\tcolor={getColorByIdx(idx)}\n\t\t\t\t\tonChartPointClick={handleChartPointClick}\n\t\t\t\t\tenableResultErrorHighlight={enableResultErrorHighlight}\n\t\t\t\t\tadditionalToolBarItems={\n\t\t\t\t\t\t<ToolbarButton\n\t\t\t\t\t\t\taria-label=\"Add to combined chart\"\n\t\t\t\t\t\t\tstate={\n\t\t\t\t\t\t\t\tisDisabled\n\t\t\t\t\t\t\t\t\t? 'disabled'\n\t\t\t\t\t\t\t\t\t: combinedState === 'active'\n\t\t\t\t\t\t\t\t\t? 'active'\n\t\t\t\t\t\t\t\t\t: 'default'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdisabled={isDisabled}\n\t\t\t\t\t\t\tonClick={() => handleChartAddClick(plot)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Icon name=\"AddSymbol\" className=\"size-5\" />\n\t\t\t\t\t\t</ToolbarButton>\n\t\t\t\t\t}\n\t\t\t\t/>\n\t\t\t</li>\n\t\t</>\n\t);\n};\n\ninterface PlotListLoadingProps {\n\tlabel: string;\n}\n\nexport const PlotListLoading = (props: PlotListLoadingProps) => {\n\tconst { label } = props;\n\treturn (\n\t\t<div className=\"bg-white rounded-md\">\n\t\t\t<CardHeader label={label}>\n\t\t\t\t<div className=\"flex items-stretch h-full gap-4\">\n\t\t\t\t\t<Skeleton className=\"w-[75px] h-full rounded\" />\n\t\t\t\t</div>\n\t\t\t</CardHeader>\n\t\t\t<ul className=\"chart-mosaic\">\n\t\t\t\t{Array.from({ length: 6 }).map((_, idx) => (\n\t\t\t\t\t<li className=\"py-2.5 px-4\" key={idx}>\n\t\t\t\t\t\t<Skeleton className=\"h-[334px] rounded\" />\n\t\t\t\t\t</li>\n\t\t\t\t))}\n\t\t\t</ul>\n\t\t</div>\n\t);\n};\n\nexport interface PlotListProps {\n\tlabel: string;\n\tplots: SingleMeasurementChart[];\n\tparameters?: string[];\n\tisFetching?: boolean;\n\tenableResultErrorHighlight?: boolean;\n\tgroup: 'trend' | 'measurement';\n}\n\nexport function PlotList(props: PlotListProps) {\n\tconst {\n\t\tplots,\n\t\tisFetching,\n\t\tlabel,\n\t\tenableResultErrorHighlight,\n\t\tgroup,\n\t\tparameters\n\t} = props;\n\tconst { handleAddChartClick, selectedCharts, selectedGroup } =\n\t\tuseCombinedView();\n\n\treturn (\n\t\t<div\n\t\t\tclassName={cn(\n\t\t\t\t'bg-white rounded-md',\n\t\t\t\tisFetching && 'pointer-events-none opacity-60'\n\t\t\t)}\n\t\t>\n\t\t\t<div className=\"bg-white rounded-md\">\n\t\t\t\t<CardHeader label={label}>\n\t\t\t\t\t<div className=\"flex items-stretch gap-4\">\n\t\t\t\t\t\t<ExportChart plots={plots} />\n\t\t\t\t\t</div>\n\t\t\t\t</CardHeader>\n\t\t\t</div>\n\t\t\t<ul\n\t\t\t\tclassName={cn(\n\t\t\t\t\t'[&>li]:border-b [&>li]:border-border-primary',\n\t\t\t\t\tplots.length !== 1 && 'min-[1465px]:chart-mosaic'\n\t\t\t\t)}\n\t\t\t>\n\t\t\t\t{plots.map((plot, idx) => {\n\t\t\t\t\tconst plotId = String(plot.id);\n\t\t\t\t\tconst state = selectedCharts.length\n\t\t\t\t\t\t? selectedCharts.find(({ plot: p }) => String(p.id) === plotId)\n\t\t\t\t\t\t\t? 'active'\n\t\t\t\t\t\t\t: 'waiting'\n\t\t\t\t\t\t: 'default';\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<PlotListItem\n\t\t\t\t\t\t\tkey={`${idx}_${plotId}`}\n\t\t\t\t\t\t\tidx={idx}\n\t\t\t\t\t\t\tplot={plot}\n\t\t\t\t\t\t\tonAddChartClick={handleAddChartClick}\n\t\t\t\t\t\t\tcombinedState={state}\n\t\t\t\t\t\t\tparameters={parameters}\n\t\t\t\t\t\t\tenableResultErrorHighlight={enableResultErrorHighlight}\n\t\t\t\t\t\t\tgroup={group}\n\t\t\t\t\t\t\tselectedGroup={selectedGroup}\n\t\t\t\t\t\t/>\n\t\t\t\t\t);\n\t\t\t\t})}\n\t\t\t</ul>\n\t\t</div>\n\t);\n}\n","/* SPDX-License-Identifier: Apache-2.0 */\n/* SPDX-FileCopyrightText: 2021-2023 OKTET Labs Ltd. */\nimport { useEffect, useMemo } from 'react';\nimport { Link } from 'react-router-dom';\nimport { ArrayParam, useQueryParam, withDefault } from 'use-query-params';\n\nimport { routes } from '@/router';\nimport { HistoryMeasurementResult } from '@/services/bublik-api';\nimport { InfoBlock, SelectedChartsPopover } from '@/shared/charts';\nimport {\n\tButtonTw,\n\tCardHeader,\n\tDataTableFacetedFilter,\n\tIcon\n} from '@/shared/tailwind-ui';\n\nimport { useHistoryQuery } from '../hooks';\nimport { useHistoryActions } from '../slice';\nimport { HistoryEmpty } from '../history-empty';\nimport { HistoryError } from '../history-error';\nimport {\n\tuseCombinedView,\n\tuseGetHistoryMeasurements,\n\tuseGetHistoryMeasurementsByResult,\n\tuseHistoryMeasurementsTitle\n} from './plot-list.hooks';\nimport { PlotList, PlotListLoading } from './plot-list.component';\n\nexport function PlotListContainer() {\n\tconst { query } = useHistoryQuery();\n\tconst { data, isLoading, isFetching, error } = useGetHistoryMeasurements();\n\tconst actions = useHistoryActions();\n\n\tuseHistoryMeasurementsTitle(query?.testName);\n\n\tconst handleOpenGlobalFormClick = () => {\n\t\tactions.toggleIsGlobalSearchOpen(true);\n\t};\n\n\tconst {\n\t\thandleRemoveClick,\n\t\thandleResetButtonClick,\n\t\tselectedCharts,\n\t\thandleOpenButtonClick,\n\t\tsyncChartsFromData\n\t} = useCombinedView();\n\n\tuseEffect(() => {\n\t\tif (data) syncChartsFromData(data);\n\t}, [data, syncChartsFromData]);\n\n\tif (!query.testName) {\n\t\treturn (\n\t\t\t<HistoryEmpty\n\t\t\t\ttype=\"no-test-name\"\n\t\t\t\tonOpenFormClick={handleOpenGlobalFormClick}\n\t\t\t/>\n\t\t);\n\t}\n\n\tif (error) {\n\t\treturn (\n\t\t\t<HistoryError error={error} onButtonClick={handleOpenGlobalFormClick} />\n\t\t);\n\t}\n\n\tif (isLoading) {\n\t\treturn <PlotListLoading label=\"Trend Charts\" />;\n\t}\n\n\tif (!data?.length) {\n\t\treturn (\n\t\t\t<HistoryEmpty\n\t\t\t\ttype=\"no-results\"\n\t\t\t\tonOpenFormClick={handleOpenGlobalFormClick}\n\t\t\t/>\n\t\t);\n\t}\n\n\treturn (\n\t\t<div className=\"flex flex-col gap-2\">\n\t\t\t<PlotList\n\t\t\t\tlabel=\"Trend Charts\"\n\t\t\t\tplots={data}\n\t\t\t\tisFetching={isFetching}\n\t\t\t\tenableResultErrorHighlight\n\t\t\t\tgroup=\"trend\"\n\t\t\t/>\n\t\t\t<SelectedChartsPopover\n\t\t\t\topen={!!selectedCharts.length}\n\t\t\t\tlabel=\"Combined\"\n\t\t\t\tplots={selectedCharts}\n\t\t\t\tonResetButtonClick={handleResetButtonClick}\n\t\t\t\tonRemoveClick={handleRemoveClick}\n\t\t\t\tonOpenButtonClick={handleOpenButtonClick}\n\t\t\t/>\n\t\t</div>\n\t);\n}\n\nexport function PlotListContainerByResult() {\n\tconst { query } = useHistoryQuery();\n\tconst { data, isLoading, error } = useGetHistoryMeasurementsByResult();\n\tconst actions = useHistoryActions();\n\n\tuseHistoryMeasurementsTitle(query?.testName);\n\n\tconst handleOpenGlobalFormClick = () => {\n\t\tactions.toggleIsGlobalSearchOpen(true);\n\t};\n\n\tconst {\n\t\thandleRemoveClick,\n\t\thandleResetButtonClick,\n\t\tselectedCharts,\n\t\thandleOpenButtonClick,\n\t\tsyncChartsFromData\n\t} = useCombinedView();\n\n\tuseEffect(() => {\n\t\tif (!data) return;\n\n\t\tconst allCharts = data.flatMap((d) => d.measurement_series_charts);\n\t\tsyncChartsFromData(allCharts);\n\t}, [data, syncChartsFromData]);\n\n\tconst uniqueParameters = useMemo(() => {\n\t\tconst all = Array.from(\n\t\t\tnew Set(data?.map((d) => d.parameters_list).flat()) ?? []\n\t\t)\n\t\t\t.sort()\n\t\t\t.map((param) => ({ label: param, value: param }));\n\n\t\treturn all;\n\t}, [data]);\n\n\tconst uniqueNames = useMemo(() => {\n\t\treturn Array.from(\n\t\t\tnew Set(\n\t\t\t\tdata\n\t\t\t\t\t?.map((d) =>\n\t\t\t\t\t\td.measurement_series_charts.map(\n\t\t\t\t\t\t\t(c) => `${c.title} - ${c.axis_y.label}`\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t\t.flat()\n\t\t\t) ?? []\n\t\t)\n\t\t\t.sort()\n\t\t\t.map((name) => ({ label: name, value: name }));\n\t}, [data]);\n\n\tconst [selectedByParam = [], setSelectedByParam] = useQueryParam(\n\t\t'parametersByResultFilter',\n\t\twithDefault(ArrayParam, []),\n\t\t{ updateType: 'replaceIn' }\n\t);\n\n\tconst [selectedByName = [], setSelectedByName] = useQueryParam(\n\t\t'parametersByResultName',\n\t\twithDefault(ArrayParam, []),\n\t\t{ updateType: 'replaceIn' }\n\t);\n\n\tif (!query.testName) {\n\t\treturn (\n\t\t\t<HistoryEmpty\n\t\t\t\ttype=\"no-test-name\"\n\t\t\t\tonOpenFormClick={handleOpenGlobalFormClick}\n\t\t\t/>\n\t\t);\n\t}\n\n\tif (error) {\n\t\treturn (\n\t\t\t<HistoryError error={error} onButtonClick={handleOpenGlobalFormClick} />\n\t\t);\n\t}\n\n\tif (isLoading) {\n\t\treturn <PlotListLoading label=\"Series Charts\" />;\n\t}\n\n\tif (!data?.length) {\n\t\treturn (\n\t\t\t<HistoryEmpty\n\t\t\t\ttype=\"no-results\"\n\t\t\t\tonOpenFormClick={handleOpenGlobalFormClick}\n\t\t\t/>\n\t\t);\n\t}\n\n\tconst filteredByParams = data.filter((m) => {\n\t\tif (!selectedByParam || !selectedByParam.length) return true;\n\t\treturn selectedByParam.every(\n\t\t\t(param) => typeof param === 'string' && m.parameters_list.includes(param)\n\t\t);\n\t});\n\n\treturn (\n\t\t<div className=\"bg-white rounded-md\">\n\t\t\t<div className=\"sticky top-0 z-10 bg-white rounded-md\">\n\t\t\t\t<CardHeader\n\t\t\t\t\tlabel={\n\t\t\t\t\t\t<div className=\"flex items-center gap-4\">\n\t\t\t\t\t\t\t<span className=\"text-text-primary text-[0.75rem] font-semibold leading-[0.875rem]\">\n\t\t\t\t\t\t\t\tSeries Charts\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<DataTableFacetedFilter\n\t\t\t\t\t\t\t\tsize=\"xss\"\n\t\t\t\t\t\t\t\ttitle=\"Charts\"\n\t\t\t\t\t\t\t\tvalue={\n\t\t\t\t\t\t\t\t\tselectedByName.filter((param) => typeof param === 'string') ??\n\t\t\t\t\t\t\t\t\t[]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tonChange={setSelectedByName}\n\t\t\t\t\t\t\t\toptions={uniqueNames}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<DataTableFacetedFilter\n\t\t\t\t\t\t\t\tsize=\"xss\"\n\t\t\t\t\t\t\t\ttitle=\"Parameters\"\n\t\t\t\t\t\t\t\tvalue={\n\t\t\t\t\t\t\t\t\tselectedByParam.filter(\n\t\t\t\t\t\t\t\t\t\t(param) => typeof param === 'string'\n\t\t\t\t\t\t\t\t\t) ?? []\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tonChange={setSelectedByParam}\n\t\t\t\t\t\t\t\toptions={uniqueParameters}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t}\n\t\t\t\t\tenableStickyShadow\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<MeasurementsList\n\t\t\t\tmeasurements={filteredByParams}\n\t\t\t\tnameFilter={\n\t\t\t\t\tselectedByName.filter((param) => typeof param === 'string') ?? []\n\t\t\t\t}\n\t\t\t\tgroup=\"measurement\"\n\t\t\t/>\n\t\t\t<SelectedChartsPopover\n\t\t\t\topen={!!selectedCharts.length}\n\t\t\t\tlabel=\"Combined\"\n\t\t\t\tplots={selectedCharts}\n\t\t\t\tonResetButtonClick={handleResetButtonClick}\n\t\t\t\tonRemoveClick={handleRemoveClick}\n\t\t\t\tonOpenButtonClick={handleOpenButtonClick}\n\t\t\t/>\n\t\t</div>\n\t);\n}\n\ninterface MeasurementListProps {\n\tmeasurements: HistoryMeasurementResult[];\n\tnameFilter?: string[];\n}\n\nfunction MeasurementsList(\n\tprops: MeasurementListProps & { group: 'trend' | 'measurement' }\n) {\n\tconst { measurements, group, nameFilter = [] } = props;\n\n\treturn (\n\t\t<div className=\"flex flex-col\">\n\t\t\t{measurements.map((m, idx) => {\n\t\t\t\tconst filtered =\n\t\t\t\t\tnameFilter.length > 0\n\t\t\t\t\t\t? m.measurement_series_charts.filter((c) =>\n\t\t\t\t\t\t\t\tnameFilter?.includes(`${c.title} - ${c.axis_y.label}`)\n\t\t\t\t\t\t  )\n\t\t\t\t\t\t: m.measurement_series_charts;\n\n\t\t\t\treturn (\n\t\t\t\t\t<div\n\t\t\t\t\t\tkey={`${idx}-${m.id}`}\n\t\t\t\t\t\tclassName=\"[&:not(:last-child)]:border-b border-border-primary\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<CardHeader label={m.test_name}>\n\t\t\t\t\t\t\t<div className=\"flex items-center gap-4\">\n\t\t\t\t\t\t\t\t<ButtonTw variant=\"secondary\" size=\"xss\" asChild>\n\t\t\t\t\t\t\t\t\t<Link to={routes.run({ runId: m.run_id })}>\n\t\t\t\t\t\t\t\t\t\t<Icon name=\"BoxArrowRight\" size={20} className=\"mr-1.5\" />\n\t\t\t\t\t\t\t\t\t\t<span>Run</span>\n\t\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t\t</ButtonTw>\n\t\t\t\t\t\t\t\t<ButtonTw variant=\"secondary\" size=\"xss\" asChild>\n\t\t\t\t\t\t\t\t\t<Link\n\t\t\t\t\t\t\t\t\t\tto={routes.measurements({\n\t\t\t\t\t\t\t\t\t\t\trunId: m.run_id,\n\t\t\t\t\t\t\t\t\t\t\tresultId: m.result_id\n\t\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<Icon name=\"BoxArrowRight\" size={20} className=\"mr-1.5\" />\n\t\t\t\t\t\t\t\t\t\t<span>Result</span>\n\t\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t\t</ButtonTw>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</CardHeader>\n\t\t\t\t\t\t<div className=\"py-2.5 px-4 border-b border-border-primary\">\n\t\t\t\t\t\t\t<InfoBlock\n\t\t\t\t\t\t\t\tname={m.test_name}\n\t\t\t\t\t\t\t\tstart={m.start}\n\t\t\t\t\t\t\t\tparameters={m.parameters_list}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{m.measurement_series_charts.length ? (\n\t\t\t\t\t\t\t<PlotList\n\t\t\t\t\t\t\t\tlabel=\"Charts\"\n\t\t\t\t\t\t\t\tplots={filtered}\n\t\t\t\t\t\t\t\tparameters={m.parameters_list}\n\t\t\t\t\t\t\t\tgroup={group}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) : null}\n\t\t\t\t\t</div>\n\t\t\t\t);\n\t\t\t})}\n\t\t</div>\n\t);\n}\n"],"names":["PlotListItem","props","idx","plot","parameters","combinedState","onAddChartClick","enableResultErrorHighlight","group","selectedGroup","isDialogOpen","setIsDialogOpen","useState","point","setPoint","handleChartPointClick","opts","dataIndex","resolvePoint","handleChartAddClick","getColorByIdx","isDisabled","jsxs","Fragment","jsx","LogPreviewContainer","MeasurementChart","ToolbarButton","Icon","PlotListLoading","label","CardHeader","Skeleton","_","PlotList","plots","isFetching","handleAddChartClick","selectedCharts","useCombinedView","cn","ExportChart","plotId","state","p","PlotListContainer","query","useHistoryQuery","data","isLoading","error","useGetHistoryMeasurements","actions","useHistoryActions","useHistoryMeasurementsTitle","handleOpenGlobalFormClick","handleRemoveClick","handleResetButtonClick","handleOpenButtonClick","syncChartsFromData","useEffect","HistoryError","SelectedChartsPopover","HistoryEmpty","PlotListContainerByResult","useGetHistoryMeasurementsByResult","allCharts","d","uniqueParameters","useMemo","param","uniqueNames","c","name","selectedByParam","setSelectedByParam","useQueryParam","withDefault","ArrayParam","selectedByName","setSelectedByName","filteredByParams","m","DataTableFacetedFilter","MeasurementsList","measurements","nameFilter","filtered","ButtonTw","Link","routes","InfoBlock"],"mappings":"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"}